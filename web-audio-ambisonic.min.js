!function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.webAudioAmbisonic=r()}}(function(){var define,module,exports;return function r(e,n,t){function i(u,a){if(!n[u]){if(!e[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[u]={exports:{}};e[u][0].call(f.exports,function(r){var n=e[u][1][r];return i(n?n:r)},f,f.exports,r,e,n,t)}return n[u].exports}for(var o="function"==typeof require&&require,u=0;u<t.length;u++)i(t[u]);return i}({1:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var i=r("babel-runtime/helpers/classCallCheck"),o=t(i),u=r("babel-runtime/helpers/createClass"),a=t(u),c=function(){function r(e,n){(0,o.default)(this,r),this.initialized=!1,this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var t=0;t<this.nCh;t++)this.decFilterNodes[t]=this.ctx.createConvolver(),this.decFilterNodes[t].normalize=!1;this.resetFilters();for(var t=0;t<this.nCh;t++){this.in.connect(this.decFilterNodes[t],t,0);var i=Math.floor(Math.sqrt(t)),u=t-i*i-i;u>=0?this.decFilterNodes[t].connect(this.gainMid):this.decFilterNodes[t].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}return(0,a.default)(r,[{key:"updateFilters",value:function(r){for(var e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,r.length,r.sampleRate),this.decFilters[e].getChannelData(0).set(r.getChannelData(e)),this.decFilterNodes[e].buffer=this.decFilters[e]}},{key:"resetFilters",value:function(){var r=new Array(this.nCh);r.fill(0),r[0]=.5,r[1]=.5/Math.sqrt(3);for(var e=0;e<this.nCh;e++)this.decFilters[e]=this.ctx.createBuffer(1,1,this.ctx.sampleRate),this.decFilters[e].getChannelData(0).set([r[e]]),this.decFilterNodes[e].buffer=this.decFilters[e]}}]),r}();n.default=c},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13}],2:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.HOA_fuma2acn=n.HOA_acn2bf=n.HOA_bf2acn=void 0;var i=r("babel-runtime/helpers/classCallCheck"),o=t(i);n.HOA_bf2acn=function r(e){(0,o.default)(this,r),this.ctx=e,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=[];for(var n=0;n<4;n++)this.gains[n]=this.ctx.createGain(),0==n?this.gains[n].gain.value=Math.SQRT2:this.gains[n].gain.value=Math.sqrt(3),this.gains[n].connect(this.out,0,n);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[3],1,0),this.in.connect(this.gains[1],2,0),this.in.connect(this.gains[2],3,0)},n.HOA_acn2bf=function r(e){(0,o.default)(this,r),this.ctx=e,this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4),this.gains=[];for(var n=0;n<4;n++)this.gains[n]=this.ctx.createGain(),0==n?this.gains[n].gain.value=Math.SQRT1_2:this.gains[n].gain.value=1/Math.sqrt(3),this.gains[n].connect(this.out,0,n);this.in.connect(this.gains[0],0,0),this.in.connect(this.gains[2],1,0),this.in.connect(this.gains[3],2,0),this.in.connect(this.gains[1],3,0)},n.HOA_fuma2acn=function r(e,n){(0,o.default)(this,r),this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gains=[],this.remapArray=[],this.remapArray.push(0,2,3,1);for(var t,i=0,u=0;u<this.nCh;u++)if(t=[],u>=(i+1)*(i+1)){i+=1;for(var a=(i+1)*(i+1);a<(i+2)*(i+2);a++)(a+i%2)%2==0?t.push(a):t.unshift(a);this.remapArray=this.remapArray.concat(t)}for(var u=0;u<this.nCh;u++)this.gains[u]=this.ctx.createGain(),this.in.connect(this.gains[u],this.remapArray[u],0),this.gains[u].connect(this.out,0,u)}},{"babel-runtime/helpers/classCallCheck":12}],3:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var i=r("babel-runtime/helpers/classCallCheck"),o=t(i),u=r("babel-runtime/helpers/createClass"),a=t(u),c=function(){function r(e){(0,o.default)(this,r),this.initialized=!1,this.ctx=e,this.fftSize=2048,this.analysers=new Array(4),this.analBuffers=new Array(4),this.in=this.ctx.createChannelSplitter(4),this.out=this.ctx.createChannelMerger(4);for(var n=0;n<4;n++)this.analysers[n]=this.ctx.createAnalyser(),this.analysers[n].fftSize=this.fftSize,this.analysers[n].smoothingTimeConstant=0,this.analBuffers[n]=new Float32Array(this.fftSize);for(var t=0;t<4;t++)this.in.connect(this.out,t,t),this.in.connect(this.analysers[t],t,0);this.initialized=!0}return(0,a.default)(r,[{key:"updateBuffers",value:function(){for(var r=0;r<4;r++)this.analysers[r].getFloatTimeDomainData(this.analBuffers[r])}},{key:"computeIntensity",value:function(){for(var r,e,n,t,i,o,u=0,a=0,c=0,s=0,f=0,h=0,l=0,m=0;m<this.fftSize;m++)u+=Math.sqrt(2)*this.analBuffers[0][m]*this.analBuffers[1][m],a+=Math.sqrt(2)*this.analBuffers[0][m]*this.analBuffers[2][m],c+=Math.sqrt(2)*this.analBuffers[0][m]*this.analBuffers[3][m],s+=2*this.analBuffers[0][m]*this.analBuffers[0][m],f+=this.analBuffers[1][m]*this.analBuffers[1][m],h+=this.analBuffers[2][m]*this.analBuffers[2][m],l+=this.analBuffers[3][m]*this.analBuffers[3][m];r=[u,a,c],e=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]),n=(s+f+h+l)/2,t=1-e/(n+1e-7),i=180*Math.atan2(a,u)/Math.PI,o=180*Math.atan2(r[2],Math.sqrt(r[0]*r[0]+r[1]*r[1]))/Math.PI;var p=[i,o,t,n];return p}}]),r}();n.default=c},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13}],4:[function(r,e,n){"use strict";function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}function i(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var o=r("babel-runtime/helpers/classCallCheck"),u=i(o),a=r("babel-runtime/helpers/createClass"),c=i(a),s=r("spherical-harmonic-transform"),f=t(s),h=function(){function r(e,n){(0,u.default)(this,r),this.initialized=!1,this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.azi=0,this.elev=0,this.gains=new Array(this.nCh),this.gainNodes=new Array(this.nCh),this.in=this.ctx.createGain(),this.in.channelCountMode="explicit",this.in.channelCount=1,this.out=this.ctx.createChannelMerger(this.nCh);for(var t=0;t<this.nCh;t++)this.gainNodes[t]=this.ctx.createGain(),this.gainNodes[t].channelCountMode="explicit",this.gainNodes[t].channelCount=1;this.updateGains();for(var t=0;t<this.nCh;t++)this.in.connect(this.gainNodes[t]),this.gainNodes[t].connect(this.out,0,t);this.initialized=!0}return(0,c.default)(r,[{key:"updateGains",value:function(){for(var r=this.order,e=f.computeRealSH(r,[[this.azi*Math.PI/180,this.elev*Math.PI/180]]),n=0;n<this.nCh;n++)this.gains[n]=e[n][0],this.gainNodes[n].gain.value=this.gains[n]}}]),r}();n.default=h},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13,"spherical-harmonic-transform":32}],5:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var i=r("babel-runtime/helpers/classCallCheck"),o=t(i),u=r("babel-runtime/helpers/createClass"),a=t(u),c=function(){function r(e,n,t){(0,o.default)(this,r),this.ctx=e,this.orderIn=n,t<n?this.orderOut=t:this.orderOut=n,this.nChIn=(this.orderIn+1)*(this.orderIn+1),this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.in=this.ctx.createChannelSplitter(this.nChIn),this.out=this.ctx.createChannelMerger(this.nChOut);for(var i=0;i<this.nChOut;i++)this.in.connect(this.out,i,i)}return(0,a.default)(r,[{key:"updateOrder",value:function(r){if(r<=this.orderIn){this.orderOut=r,this.nChOut=(this.orderOut+1)*(this.orderOut+1),this.out.disconnect(),this.out=this.ctx.createChannelMerger(this.nChOut);for(var e=0;e<this.nChOut;e++)this.in.connect(this.out,e,e)}}}]),r}();n.default=c},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13}],6:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var i=r("babel-runtime/helpers/classCallCheck"),o=t(i),u=r("babel-runtime/helpers/createClass"),a=t(u),c=function(){function r(e,n){(0,o.default)(this,r),this.initialized=!1,this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.fftSize=2048,this.analysers=new Array(this.nCh),this.analBuffers=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var t=0;t<this.nCh;t++)this.analysers[t]=this.ctx.createAnalyser(),this.analysers[t].fftSize=this.fftSize,this.analysers[t].smoothingTimeConstant=0,this.analBuffers[t]=new Float32Array(this.fftSize);for(var i=0;i<this.nCh;i++)this.in.connect(this.out,i,i),this.in.connect(this.analysers[i],i,0);this.initialized=!0}return(0,a.default)(r,[{key:"updateBuffers",value:function(){for(var r=0;r<this.nCh;r++)this.analysers[r].getFloatTimeDomainData(this.analBuffers[r])}},{key:"computeIntensity",value:function(){for(var r,e,n,t,i,o=new Array(this.nCh).fill(0),u=new Array(this.nCh).fill(0),a=0;a<this.fftSize;a++)for(var c=0;c<this.nCh;c++)0==c?u[c]+=2*this.analBuffers[c][a]*this.analBuffers[c][a]:(u[c]+=this.analBuffers[c][a]*this.analBuffers[c][a],o[c]+=Math.sqrt(2)*this.analBuffers[0][a]*this.analBuffers[c][a]);for(var s=0,f=0,h=0;h<o.length;h++)0!=h&&(s+=o[h]*o[h]),f+=u[h];r=Math.sqrt(s),e=f/2,n=1-r/(e+1e-7),t=180*Math.atan2(o[1],o[3])/Math.PI,i=180*Math.atan2(o[2],Math.sqrt(o[1]*o[1]+o[3]*o[3]))/Math.PI;var l=[t,i,n,e];return l}}]),r}();n.default=c},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13}],7:[function(r,e,n){"use strict";function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}function i(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var o=r("babel-runtime/helpers/classCallCheck"),u=i(o),a=r("babel-runtime/helpers/createClass"),c=i(a),s=r("spherical-harmonic-transform"),f=t(s),h=function(){function r(e,n){(0,u.default)(this,r),this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=numeric.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=null,this.out=null,this.initialized=!1}return(0,c.default)(r,[{key:"updateRotMtx",value:function(){if(this.initialized){var r=this.yaw*Math.PI/180,e=this.pitch*Math.PI/180,n=this.roll*Math.PI/180;this.rotMtx=f.getSHrotMtx(f.yawPitchRoll2Rzyx(r,e,n),this.order);for(var t=1,i=1;i<this.order+1;i++){for(var o=0;o<2*i+1;o++)for(var u=0;u<2*i+1;u++)this.rotMtxNodes[i-1][o][u].gain.value=this.rotMtx[t+o][t+u];t=t+2*i+1}}}},{key:"init",value:function(){if(!this.initialized){this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var r=1;r<this.order+1;r++){for(var e=new Array(2*r+1),n=0;n<2*r+1;n++){e[n]=new Array(2*r+1);for(var t=0;t<2*r+1;t++)e[n][t]=this.ctx.createGain(),n==t?e[n][t].gain.value=1:e[n][t].gain.value=0}this.rotMtxNodes[r-1]=e}this.in.connect(this.out,0,0);for(var i=1,o=1;o<this.order+1;o++){for(var u=0;u<2*o+1;u++)for(var a=0;a<2*o+1;a++)this.in.connect(this.rotMtxNodes[o-1][u][a],i+a,0),this.rotMtxNodes[o-1][u][a].connect(this.out,0,i+u);i=i+2*o+1}this.initialized=!0}}}]),r}();n.default=h},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13,"spherical-harmonic-transform":32}],8:[function(r,e,n){"use strict";function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}function i(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var o=r("babel-runtime/helpers/classCallCheck"),u=i(o),a=r("babel-runtime/helpers/createClass"),c=i(a),s=r("spherical-harmonic-transform"),f=t(s),h=function(){function r(e,n){(0,u.default)(this,r),this.initialized=!1,this.ctx=e,this.order=n,this.nCh=(n+1)*(n+1),this.azi=0,this.elev=0,this.vmicGains=new Array(this.nCh),this.vmicGainNodes=new Array(this.nCh),this.vmicCoeffs=new Array(this.order+1),this.vmicPattern="hypercardioid",this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createGain();for(var t=0;t<this.nCh;t++)this.vmicGainNodes[t]=this.ctx.createGain();for(this.SHxyz=new Array(this.nCh),this.SHxyz.fill(0),this.updatePattern(),this.updateOrientation(),t=0;t<this.nCh;t++)this.in.connect(this.vmicGainNodes[t],t,0),this.vmicGainNodes[t].connect(this.out);this.initialized=!0}return(0,c.default)(r,[{key:"updatePattern",value:function(){function r(r){for(var e=new Array(r+1),n=0;n<r+1;n++)e[n]=Math.sqrt(2*n+1)*f.factorial(r)*f.factorial(r+1)/(f.factorial(r+n+1)*f.factorial(r-n))/(r+1);return e}function e(r){var e=new Array(r+1);return e.fill(1),e}function n(r){var e=new Array(r+1);e[0]=1;for(var n=0,t=0,i=0,o=1;o<r+1;o++)i=f.recurseLegendrePoly(o,[Math.cos(2.406809/(r+1.51))],n,t),e[o]=i[0][0],t=n,n=i;return e}switch(this.vmicPattern){case"cardioid":this.vmicCoeffs=r(this.order);break;case"supercardioid":break;case"hypercardioid":this.vmicCoeffs=e(this.order);break;case"max_rE":this.vmicCoeffs=n(this.order);break;default:this.vmicPattern="hypercardioid",this.vmicCoeffs=e(this.order)}this.updateGains()}},{key:"updateOrientation",value:function(){for(var r=this.azi*Math.PI/180,e=this.elev*Math.PI/180,n=f.computeRealSH(this.order,[[r,e]]),t=1;t<this.nCh;t++)this.SHxyz[t]=n[t][0];this.updateGains()}},{key:"updateGains",value:function(){for(var r,e=0;e<this.order+1;e++)for(var n=-this.order;n<this.order+1;n++)r=e*e+e+n,this.vmicGains[r]=1/Math.sqrt(2*e+1)*this.vmicCoeffs[e]*this.SHxyz[r];for(var t=1;t<this.nCh;t++)this.vmicGainNodes[t].gain.value=this.vmicGains[t]}}]),r}();n.default=h},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13,"spherical-harmonic-transform":32}],9:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0});var i=r("babel-runtime/helpers/classCallCheck"),o=t(i),u=r("babel-runtime/helpers/createClass"),a=t(u),c=function(){function r(e,n,t,i){function u(r,e){return("000000000"+r).substr(-e)}(0,o.default)(this,r),this.context=e,this.order=n,this.nCh=(n+1)*(n+1),this.nChGroups=Math.ceil(this.nCh/8),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=i,this.urls=new Array(this.nChGroups);for(var a=t.slice(t.length-3,t.length),c=0;c<this.nChGroups;c++)c==this.nChGroups-1?this.urls[c]=t.slice(0,t.length-4)+"_"+u(8*c+1,2)+"-"+u(this.nCh,2)+"ch."+a:this.urls[c]=t.slice(0,t.length-4)+"_"+u(8*c+1,2)+"-"+u(8*c+8,2)+"ch."+a}return(0,a.default)(r,[{key:"loadBuffers",value:function(r,e){var n=new XMLHttpRequest;n.open("GET",r,!0),n.responseType="arraybuffer";var t=this;n.onload=function(){t.context.decodeAudioData(n.response,function(n){return n?(t.buffers[e]=n,t.loadCount++,void(t.loadCount==t.nChGroups&&(t.loaded=!0,t.concatBuffers(),console.log("HOAloader: all buffers loaded and concatenated"),t.onLoad(t.concatBuffer)))):void alert("error decoding file data: "+r)},function(r){console.error("decodeAudioData error",r)})},n.onerror=function(){alert("HOAloader: XHR error")},n.send()}},{key:"load",value:function(){for(var r=0;r<this.nChGroups;++r)this.loadBuffers(this.urls[r],r)}},{key:"concatBuffers",value:function(){if(this.loaded){var r=this.nCh,e=this.nChGroups,n=this.buffers[0].length,t=this.buffers[0].sampleRate;this.concatBuffer=this.context.createBuffer(r,n,t);for(var i=0;i<e;i++)for(var o=0;o<this.buffers[i].numberOfChannels;o++)this.concatBuffer.getChannelData(8*i+o).set(this.buffers[i].getChannelData(o))}}}]),r}();n.default=c},{"babel-runtime/helpers/classCallCheck":12,"babel-runtime/helpers/createClass":13}],10:[function(r,e,n){"use strict";function t(r){if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}function i(r){return r&&r.__esModule?r:{default:r}}Object.defineProperty(n,"__esModule",{value:!0}),n.Bformat_analyser=n.hoa_converters=n.HOAloader=n.HOA_analyser=n.HOA_vmic=n.HOA_binDecoder=n.HOA_rotator=n.HOA_orderLimiter=n.HOA_encoder=void 0;var o=r("./ambi-monoEncoder");Object.defineProperty(n,"HOA_encoder",{enumerable:!0,get:function(){return i(o).default}});var u=r("./ambi-orderLimiter");Object.defineProperty(n,"HOA_orderLimiter",{enumerable:!0,get:function(){return i(u).default}});var a=r("./ambi-sceneRotator");Object.defineProperty(n,"HOA_rotator",{enumerable:!0,get:function(){return i(a).default}});var c=r("./ambi-binauralDecoder");Object.defineProperty(n,"HOA_binDecoder",{enumerable:!0,get:function(){return i(c).default}});var s=r("./ambi-virtualMic");Object.defineProperty(n,"HOA_vmic",{enumerable:!0,get:function(){return i(s).default}});var f=r("./ambi-powermapAnalyser");Object.defineProperty(n,"HOA_analyser",{enumerable:!0,get:function(){return i(f).default}});var h=r("./hoa-loader");Object.defineProperty(n,"HOAloader",{enumerable:!0,get:function(){return i(h).default}});var l=r("./ambi-intensityAnalyser");Object.defineProperty(n,"Bformat_analyser",{enumerable:!0,get:function(){return i(l).default}});var m=r("./ambi-converters"),p=t(m);n.hoa_converters=p},{"./ambi-binauralDecoder":1,"./ambi-converters":2,"./ambi-intensityAnalyser":3,"./ambi-monoEncoder":4,"./ambi-orderLimiter":5,"./ambi-powermapAnalyser":6,"./ambi-sceneRotator":7,"./ambi-virtualMic":8,"./hoa-loader":9}],11:[function(r,e,n){e.exports={default:r("core-js/library/fn/object/define-property"),__esModule:!0}},{"core-js/library/fn/object/define-property":14}],12:[function(r,e,n){"use strict";n.__esModule=!0,n.default=function(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}},{}],13:[function(r,e,n){"use strict";function t(r){return r&&r.__esModule?r:{default:r}}n.__esModule=!0;var i=r("../core-js/object/define-property"),o=t(i);n.default=function(){function r(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),(0,o.default)(r,t.key,t)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}()},{"../core-js/object/define-property":11}],14:[function(r,e,n){r("../../modules/es6.object.define-property");var t=r("../../modules/_core").Object;e.exports=function(r,e,n){return t.defineProperty(r,e,n)}},{"../../modules/_core":17,"../../modules/es6.object.define-property":30}],15:[function(r,e,n){e.exports=function(r){if("function"!=typeof r)throw TypeError(r+" is not a function!");return r}},{}],16:[function(r,e,n){var t=r("./_is-object");e.exports=function(r){if(!t(r))throw TypeError(r+" is not an object!");return r}},{"./_is-object":26}],17:[function(r,e,n){var t=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=t)},{}],18:[function(r,e,n){var t=r("./_a-function");e.exports=function(r,e,n){if(t(r),void 0===e)return r;switch(n){case 1:return function(n){return r.call(e,n)};case 2:return function(n,t){return r.call(e,n,t)};case 3:return function(n,t,i){return r.call(e,n,t,i)}}return function(){return r.apply(e,arguments)}}},{"./_a-function":15}],19:[function(r,e,n){e.exports=!r("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":22}],20:[function(r,e,n){var t=r("./_is-object"),i=r("./_global").document,o=t(i)&&t(i.createElement);e.exports=function(r){return o?i.createElement(r):{}}},{"./_global":23,"./_is-object":26}],21:[function(r,e,n){var t=r("./_global"),i=r("./_core"),o=r("./_ctx"),u=r("./_hide"),a="prototype",c=function(r,e,n){var s,f,h,l=r&c.F,m=r&c.G,p=r&c.S,d=r&c.P,y=r&c.B,v=r&c.W,g=m?i:i[e]||(i[e]={}),x=g[a],b=m?t:p?t[e]:(t[e]||{})[a];m&&(n=e);for(s in n)f=!l&&b&&void 0!==b[s],f&&s in g||(h=f?b[s]:n[s],g[s]=m&&"function"!=typeof b[s]?n[s]:y&&f?o(h,t):v&&b[s]==h?function(r){var e=function(e,n,t){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,n)}return new r(e,n,t)}return r.apply(this,arguments)};return e[a]=r[a],e}(h):d&&"function"==typeof h?o(Function.call,h):h,d&&((g.virtual||(g.virtual={}))[s]=h,r&c.R&&x&&!x[s]&&u(x,s,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},{"./_core":17,"./_ctx":18,"./_global":23,"./_hide":24}],22:[function(r,e,n){e.exports=function(r){try{return!!r()}catch(r){return!0}}},{}],23:[function(r,e,n){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},{}],24:[function(r,e,n){var t=r("./_object-dp"),i=r("./_property-desc");e.exports=r("./_descriptors")?function(r,e,n){return t.f(r,e,i(1,n))}:function(r,e,n){return r[e]=n,r}},{"./_descriptors":19,"./_object-dp":27,"./_property-desc":28}],25:[function(r,e,n){e.exports=!r("./_descriptors")&&!r("./_fails")(function(){return 7!=Object.defineProperty(r("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":19,"./_dom-create":20,"./_fails":22}],26:[function(r,e,n){e.exports=function(r){return"object"==typeof r?null!==r:"function"==typeof r}},{}],27:[function(r,e,n){var t=r("./_an-object"),i=r("./_ie8-dom-define"),o=r("./_to-primitive"),u=Object.defineProperty;n.f=r("./_descriptors")?Object.defineProperty:function(r,e,n){if(t(r),e=o(e,!0),t(n),i)try{return u(r,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(r[e]=n.value),r}},{"./_an-object":16,"./_descriptors":19,"./_ie8-dom-define":25,"./_to-primitive":29}],28:[function(r,e,n){e.exports=function(r,e){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:e}}},{}],29:[function(r,e,n){var t=r("./_is-object");e.exports=function(r,e){if(!t(r))return r;var n,i;if(e&&"function"==typeof(n=r.toString)&&!t(i=n.call(r)))return i;if("function"==typeof(n=r.valueOf)&&!t(i=n.call(r)))return i;if(!e&&"function"==typeof(n=r.toString)&&!t(i=n.call(r)))return i;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":26}],30:[function(r,e,n){var t=r("./_export");t(t.S+t.F*!r("./_descriptors"),"Object",{defineProperty:r("./_object-dp").f})},{"./_descriptors":19,"./_export":21,"./_object-dp":27}],31:[function(require,module,exports){(function(global){"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(r,e){var n,t,i,o;for("undefined"==typeof e&&(e=15),i=.5,n=new Date;;){for(i*=2,o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;if(t=new Date,t-n>e)break}for(o=i;o>3;o-=4)r(),r(),r(),r();for(;o>0;)r(),o--;return t=new Date,1e3*(3*i-1)/(t-n)},numeric._myIndexOf=function(r){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===r)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function e(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+e(-r);if(isFinite(r)){var n=Math.floor(Math.log(r)/Math.log(10)),t=r/Math.pow(10,n),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,t=1,i=t.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}function n(r){var i;if("undefined"==typeof r)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return t.push('"'+r+'"'),!1;if("boolean"==typeof r)return t.push(r.toString()),!1;if("number"==typeof r){var o=e(r),u=r.toPrecision(numeric.precision),a=parseFloat(r.toString()).toString(),c=[o,u,a,parseFloat(u).toString(),parseFloat(a).toString()];for(i=1;i<c.length;i++)c[i].length<o.length&&(o=c[i]);return t.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===r)return t.push("null"),!1;if("function"==typeof r){t.push(r.toString());var s=!1;for(i in r)r.hasOwnProperty(i)&&(s?t.push(",\n"):t.push("\n{"),s=!0,t.push(i),t.push(": \n"),n(r[i]));return s&&t.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return t.push("...Large Array..."),!0;var s=!1;for(t.push("["),i=0;i<r.length;i++)i>0&&(t.push(","),s&&t.push("\n ")),s=n(r[i]);return t.push("]"),!0}t.push("{");var s=!1;for(i in r)r.hasOwnProperty(i)&&(s&&t.push(",\n"),s=!0,t.push(i),t.push(": \n"),n(r[i]));return t.push("}"),!0}var t=[];return n(r),t.join("")},numeric.parseDate=function(r){function e(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseFloat=function(r){function e(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,t=[];for(n=0;n<r.length;n++)t[n]=e(r[n]);return t}return e(r)},numeric.parseCSV=function(r){var e,n,t=r.split("\n"),i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(r){return r.substr(0,r.length-1)},c=0;for(n=0;n<t.length;n++){var s,f=(t[n]+",").match(o);if(f.length>0){for(i[c]=[],e=0;e<f.length;e++)s=a(f[e]),u.test(s)?i[c][e]=parseFloat(s):i[c][e]=s;c++}}return i},numeric.toCSV=function(r){var e,n,t,i,o,u,a=numeric.dim(r);for(t=a[0],i=a[1],u=[],e=0;e<t;e++){for(o=[],n=0;n<t;n++)o[n]=r[e][n].toString();u[e]=o.join(", ")}return u.join("\n")+"\n"},numeric.getURL=function(r){var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(),e},numeric.imageURL=function(r){function e(r){var e,n,t,i,o,u,a,c,s=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(e=0;e<s;e+=3)n=r[e],t=r[e+1],i=r[e+2],o=n>>2,u=((3&n)<<4)+(t>>4),a=((15&t)<<2)+(i>>6),c=63&i,e+1>=s?a=c=64:e+2>=s&&(c=64),h+=f.charAt(o)+f.charAt(u)+f.charAt(a)+f.charAt(c);return h}function n(r,e,n){"undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=r.length);var t,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,u=0;r.length;for(t=e;t<n;t++)u=255&(o^r[t]),o=o>>>8^i[u];return o^-1}var t,i,o,u,a,c,s,f,h,l,m=r[0].length,p=r[0][0].length,d=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,m>>24&255,m>>16&255,m>>8&255,255&m,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(l=n(d,12,29),d[29]=l>>24&255,d[30]=l>>16&255,d[31]=l>>8&255,d[32]=255&l,t=1,i=0,s=0;s<m;s++){for(s<m-1?d.push(0):d.push(1),a=3*p+1+(0===s)&255,c=3*p+1+(0===s)>>8&255,d.push(a),d.push(c),d.push(255&~a),d.push(255&~c),0===s&&d.push(0),f=0;f<p;f++)for(o=0;o<3;o++)a=r[o][s][f],a=a>255?255:a<0?0:Math.round(a),t=(t+a)%65521,i=(i+t)%65521,d.push(a);d.push(0)}return h=(i<<16)+t,d.push(h>>24&255),d.push(h>>16&255),d.push(h>>8&255),d.push(255&h),u=d.length-41,d[33]=u>>24&255,d[34]=u>>16&255,d[35]=u>>8&255,d[36]=255&u,l=n(d,37),d.push(l>>24&255),d.push(l>>16&255),d.push(l>>8&255),d.push(255&l),d.push(0),d.push(0),d.push(0),d.push(0),d.push(73),d.push(69),d.push(78),d.push(68),d.push(174),d.push(66),d.push(96),d.push(130),"data:image/png;base64,"+e(d)},numeric._dim=function(r){for(var e=[];"object"==typeof r;)e.push(r.length),r=r[0];return e},numeric.dim=function(r){var e,n;return"object"==typeof r?(e=r[0],"object"==typeof e?(n=e[0],"object"==typeof n?numeric._dim(r):[r.length,e.length]):[r.length]):[]},numeric.mapreduce=function(r,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+r+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+r+";\n    xi = x[i-1];\n    "+r+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+r+"\n}\nreturn accum;")},numeric.mapreduce2=function(r,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+r+";\n}\nreturn accum;")},numeric.same=function r(e,n){var t,i;if(!(e instanceof Array&&n instanceof Array))return!1;if(i=e.length,i!==n.length)return!1;for(t=0;t<i;t++)if(e[t]!==n[t]){if("object"!=typeof e[t])return!1;if(!r(e[t],n[t]))return!1}return!0},numeric.rep=function(r,e,n){"undefined"==typeof n&&(n=0);var t,i=r[n],o=Array(i);if(n===r.length-1){for(t=i-2;t>=0;t-=2)o[t+1]=e,o[t]=e;return t===-1&&(o[0]=e),o}for(t=i-1;t>=0;t--)o[t]=numeric.rep(r,e,n+1);return o},numeric.dotMMsmall=function(r,e){var n,t,i,o,u,a,c,s,f,h,l;
for(o=r.length,u=e.length,a=e[0].length,c=Array(o),n=o-1;n>=0;n--){for(s=Array(a),f=r[n],i=a-1;i>=0;i--){for(h=f[u-1]*e[u-1][i],t=u-2;t>=1;t-=2)l=t-1,h+=f[t]*e[t][i]+f[l]*e[l][i];0===t&&(h+=f[0]*e[0][i]),s[i]=h}c[n]=s}return c},numeric._getCol=function(r,e,n){var t,i=r.length;for(t=i-1;t>0;--t)n[t]=r[t][e],--t,n[t]=r[t][e];0===t&&(n[0]=r[0][e])},numeric.dotMMbig=function(r,e){var n,t,i,o,u=numeric._getCol,a=e.length,c=Array(a),s=r.length,f=e[0].length,h=new Array(s),l=numeric.dotVV;for(--a,--s,t=s;t!==-1;--t)h[t]=Array(f);for(--f,t=f;t!==-1;--t)for(u(e,t,c),i=s;i!==-1;--i)o=0,n=r[i],h[i][t]=l(n,c);return h},numeric.dotMV=function(r,e){var n,t=r.length,i=(e.length,Array(t)),o=numeric.dotVV;for(n=t-1;n>=0;n--)i[n]=o(r[n],e);return i},numeric.dotVM=function(r,e){var n,t,i,o,u,a,c;for(i=r.length,o=e[0].length,u=Array(o),t=o-1;t>=0;t--){for(a=r[i-1]*e[i-1][t],n=i-2;n>=1;n-=2)c=n-1,a+=r[n]*e[n][t]+r[c]*e[c][t];0===n&&(a+=r[0]*e[0][t]),u[t]=a}return u},numeric.dotVV=function(r,e){var n,t,i=r.length,o=r[i-1]*e[i-1];for(n=i-2;n>=1;n-=2)t=n-1,o+=r[n]*e[n]+r[t]*e[t];return 0===n&&(o+=r[0]*e[0]),o},numeric.dot=function(r,e){var n=numeric.dim;switch(1e3*n(r).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(r,e):numeric.dotMMbig(r,e);case 2001:return numeric.dotMV(r,e);case 1002:return numeric.dotVM(r,e);case 1001:return numeric.dotVV(r,e);case 1e3:return numeric.mulVS(r,e);case 1:return numeric.mulSV(r,e);case 0:return r*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(r){var e,n,t,i,o=r.length,u=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),n=e+2,t=o-1;t>=n;t-=2)i[t]=0,i[t-1]=0;for(t>e&&(i[t]=0),i[e]=r[e],t=e-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),u[e]=i}return u},numeric.getDiag=function(r){var e,n=Math.min(r.length,r[0].length),t=Array(n);for(e=n-1;e>=1;--e)t[e]=r[e][e],--e,t[e]=r[e][e];return 0===e&&(t[0]=r[0][0]),t},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric.pointwise=function(r,e,n){"undefined"==typeof n&&(n="");var t,i,o=[],u=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)u.test(r[t])?(i=r[t].substring(0,r[t].length-3),a=i):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="_s",o[r.length+1]="_k",o[r.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+r.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(r,e,n){"undefined"==typeof n&&(n="");var t,i,o=[],u=/\[i\]$/,a="",c=!1;for(t=0;t<r.length;t++)u.test(r[t])?(i=r[t].substring(0,r[t].length-3),a=i):i=r[t],"ret"===i&&(c=!0),o.push(i);return o[r.length]="var _n = "+a+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function r(e,n,t,i,o){if(i===t.length-1)return void o(e,n);var u,a=t[i];for(u=a-1;u>=0;u--)r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o)},numeric._biforeach2=function r(e,n,t,i,o){if(i===t.length-1)return o(e,n);var u,a=t[i],c=Array(a);for(u=a-1;u>=0;--u)c[u]=r("object"==typeof e?e[u]:e,"object"==typeof n?n[u]:n,t,i+1,o);return c},numeric._foreach=function r(e,n,t,i){if(t===n.length-1)return void i(e);var o,u=n[t];for(o=u-1;o>=0;o--)r(e[o],n,t+1,i)},numeric._foreach2=function r(e,n,t,i){if(t===n.length-1)return i(e);var o,u=n[t],a=Array(u);for(o=u-1;o>=0;o--)a[o]=r(e[o],n,t+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var r,e;for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],numeric.ops2[e]=e;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){e=numeric.ops2[r];var n,t,i="";numeric.myIndexOf.call(numeric.mathfuns2,r)!==-1?(i="var "+e+" = Math."+e+";\n",n=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},t=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(n=function(r,n,t){return r+" = "+n+" "+e+" "+t},t=numeric.opseq.hasOwnProperty(r+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),numeric[r+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[r+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[r+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[r]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+r+"VV, VS = numeric."+r+"VS, SV = numeric."+r+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[r],numeric[r+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[r+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[r+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+r+"eqV, S = numeric."+r+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(r=0;r<numeric.mathfuns2.length;++r)e=numeric.mathfuns2[r],delete numeric.ops2[e];for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],numeric.ops1[e]=e;for(r in numeric.ops1)numeric.ops1.hasOwnProperty(r)&&(i="",e=numeric.ops1[r],numeric.myIndexOf.call(numeric.mathfuns,r)!==-1&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[r+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[r+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+r+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[r+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[r]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+r+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(r=0;r<numeric.mathfuns.length;++r)e=numeric.mathfuns[r],delete numeric.ops1[e];for(r in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(r)&&(e=numeric.mapreducers[r],numeric[r+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[r]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+r+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(r,e){return"object"==typeof r?"object"==typeof e?numeric.truncVV(r,e):numeric.truncVS(r,e):"object"==typeof e?numeric.truncSV(r,e):Math.round(r/e)*e},numeric.inv=function(r){var e,n,t,i,o,u,a,r,c=numeric.dim(r),s=Math.abs,f=c[0],h=c[1],l=numeric.clone(r),m=numeric.identity(f);for(u=0;u<h;++u){var p=-1,d=-1;for(o=u;o!==f;++o)a=s(l[o][u]),a>d&&(p=o,d=a);for(n=l[p],l[p]=l[u],l[u]=n,i=m[p],m[p]=m[u],m[u]=i,r=n[u],a=u;a!==h;++a)n[a]/=r;for(a=h-1;a!==-1;--a)i[a]/=r;for(o=f-1;o!==-1;--o)if(o!==u){for(e=l[o],t=m[o],r=e[u],a=u+1;a!==h;++a)e[a]-=n[a]*r;for(a=h-1;a>0;--a)t[a]-=i[a]*r,--a,t[a]-=i[a]*r;0===a&&(t[0]-=i[0]*r)}}return m},numeric.det=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,t,i,o,u,a,c,s,f=e[0],h=1,l=numeric.clone(r);for(t=0;t<f-1;t++){for(i=t,n=t+1;n<f;n++)Math.abs(l[n][t])>Math.abs(l[i][t])&&(i=n);for(i!==t&&(c=l[i],l[i]=l[t],l[t]=c,h*=-1),o=l[t],n=t+1;n<f;n++){for(u=l[n],a=u[t]/o[t],i=t+1;i<f-1;i+=2)s=i+1,u[i]-=o[i]*a,u[s]-=o[s]*a;i!==f&&(u[i]-=o[i]*a)}if(0===o[t])return 0;h*=o[t]}return h*l[t][t]},numeric.transpose=function(r){var e,n,t,i,o,u=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)o=c[n],o[e]=i[n],o[e-1]=t[n],--n,o=c[n],o[e]=i[n],o[e-1]=t[n];0===n&&(o=c[0],o[e]=i[0],o[e-1]=t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=t[n],--n,c[n][0]=t[n];0===n&&(c[0][0]=t[0])}return c},numeric.negtranspose=function(r){var e,n,t,i,o,u=r.length,a=r[0].length,c=Array(a);for(n=0;n<a;n++)c[n]=Array(u);for(e=u-1;e>=1;e-=2){for(i=r[e],t=r[e-1],n=a-1;n>=1;--n)o=c[n],o[e]=-i[n],o[e-1]=-t[n],--n,o=c[n],o[e]=-i[n],o[e-1]=-t[n];0===n&&(o=c[0],o[e]=-i[0],o[e-1]=-t[0])}if(0===e){for(t=r[0],n=a-1;n>=1;--n)c[n][0]=-t[n],--n,c[n][0]=-t[n];0===n&&(c[0][0]=-t[0])}return c},numeric._random=function r(e,n){var t,i,o=e[n],u=Array(o);if(n===e.length-1){for(i=Math.random,t=o-1;t>=1;t-=2)u[t]=i(),u[t-1]=i();return 0===t&&(u[0]=i()),u}for(t=o-1;t>=0;t--)u[t]=r(e,n+1);return u},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r){return Math.sqrt(numeric.norm2Squared(r))},numeric.linspace=function(r,e,n){if("undefined"==typeof n&&(n=Math.max(Math.round(e-r)+1,1)),n<2)return 1===n?[r]:[];var t,i=Array(n);for(n--,t=n;t>=0;t--)i[t]=(t*e+(n-t)*r)/n;return i},numeric.getBlock=function(r,e,n){function t(r,o){var u,a=e[o],c=n[o]-a,s=Array(c);if(o===i.length-1){for(u=c;u>=0;u--)s[u]=r[u+a];return s}for(u=c;u>=0;u--)s[u]=t(r[u+a],o+1);return s}var i=numeric.dim(r);return t(r,0)},numeric.setBlock=function(r,e,n,t){function i(r,t,u){var a,c=e[u],s=n[u]-c;if(u===o.length-1)for(a=s;a>=0;a--)r[a+c]=t[a];for(a=s;a>=0;a--)i(r[a+c],t[a],u+1)}var o=numeric.dim(r);return i(r,t,0),r},numeric.getRange=function(r,e,n){var t,i,o,u,a=e.length,c=n.length,s=Array(a);for(t=a-1;t!==-1;--t)for(s[t]=Array(c),o=s[t],u=r[e[t]],i=c-1;i!==-1;--i)o[i]=u[n[i]];return s},numeric.blockMatrix=function(r){var e=numeric.dim(r);if(e.length<4)return numeric.blockMatrix([r]);var n,t,i,o,u,a=e[0],c=e[1];for(n=0,t=0,i=0;i<a;++i)n+=r[i][0].length;for(o=0;o<c;++o)t+=r[0][o][0].length;var s=Array(n);for(i=0;i<n;++i)s[i]=Array(t);var f,h,l,m,p,d=0;for(i=0;i<a;++i){for(f=t,o=c-1;o!==-1;--o)for(u=r[i][o],f-=u[0].length,l=u.length-1;l!==-1;--l)for(p=u[l],h=s[d+l],m=p.length-1;m!==-1;--m)h[f+m]=p[m];d+=r[i][0].length}return s},numeric.tensor=function(r,e){if("number"==typeof r||"number"==typeof e)return numeric.mul(r,e);var n=numeric.dim(r),t=numeric.dim(e);if(1!==n.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,u,a,c=n[0],s=t[0],f=Array(c);for(o=c-1;o>=0;o--){for(i=Array(s),a=r[o],u=s-1;u>=3;--u)i[u]=a*e[u],--u,i[u]=a*e[u],--u,i[u]=a*e[u],--u,i[u]=a*e[u];for(;u>=0;)i[u]=a*e[u],--u;f[o]=i}return f},numeric.T=function(r,e){this.x=r,this.y=e},numeric.t=function(r,e){return new numeric.T(r,e)},numeric.Tbinop=function(r,e,n,t,i){numeric.indexOf;if("string"!=typeof i){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(r.indexOf(o)>=0||e.indexOf(o)>=0||n.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function r(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var r=numeric.div;return this.y?new numeric.T(r(this.x,e.x),r(this.y,e.x)):new numeric.T(r(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(r(e),numeric.negtranspose(n)):new numeric.T(r(e))},numeric.Tunop=function(r,e,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var e,n,t,i,o,u,a,c,s,f,h,e,n,t,l,m,p,d,y,v,g,x=r.x.length,b=numeric.identity(x),M=numeric.rep([x,x],0),w=numeric.clone(r.x),_=numeric.clone(r.y);for(e=0;e<x;e++){for(p=w[e][e],d=_[e][e],l=p*p+d*d,t=e,n=e+1;n<x;n++)p=w[n][e],d=_[n][e],m=p*p+d*d,m>l&&(t=n,l=m);for(t!==e&&(g=w[e],w[e]=w[t],w[t]=g,g=_[e],_[e]=_[t],_[t]=g,g=b[e],b[e]=b[t],b[t]=g,g=M[e],M[e]=M[t],M[t]=g),i=w[e],o=_[e],c=b[e],s=M[e],p=i[e],d=o[e],n=e+1;n<x;n++)y=i[n],v=o[n],i[n]=(y*p+v*d)/l,o[n]=(v*p-y*d)/l;for(n=0;n<x;n++)y=c[n],v=s[n],c[n]=(y*p+v*d)/l,s[n]=(v*p-y*d)/l;for(n=e+1;n<x;n++){for(u=w[n],a=_[n],f=b[n],h=M[n],p=u[e],d=a[e],t=e+1;t<x;t++)y=i[t],v=o[t],u[t]-=y*p-v*d,a[t]-=v*p+y*d;for(t=0;t<x;t++)y=c[t],v=s[t],f[t]-=y*p-v*d,h[t]-=v*p+y*d}}for(e=x-1;e>0;e--)for(c=b[e],s=M[e],n=e-1;n>=0;n--)for(f=b[n],h=M[n],p=w[n][e],d=_[n][e],t=x-1;t>=0;t--)y=c[t],v=s[t],f[t]-=p*y-d*v,h[t]-=p*v+d*y;return new numeric.T(b,M)},numeric.T.prototype.get=function(r){var e,n=this.x,t=this.y,i=0,o=r.length;if(t){for(;i<o;)e=r[i],n=n[e],t=t[e],i++;return new numeric.T(n,t)}for(;i<o;)e=r[i],n=n[e],i++;return new numeric.T(n)},numeric.T.prototype.set=function(r,e){var n,t=this.x,i=this.y,o=0,u=r.length,a=e.x,c=e.y;if(0===u)return c?this.y=c:i&&(this.y=void 0),this.x=t,this;if(c){for(i||(i=numeric.rep(numeric.dim(t),0),this.y=i);o<u-1;)n=r[o],t=t[n],i=i[n],o++;return n=r[o],t[n]=a,i[n]=c,this}if(i){for(;o<u-1;)n=r[o],t=t[n],i=i[n],o++;return n=r[o],t[n]=a,a instanceof Array?i[n]=numeric.rep(numeric.dim(a),0):i[n]=0,this}for(;o<u-1;)n=r[o],t=t[n],o++;return n=r[o],t[n]=a,this},numeric.T.prototype.getRows=function(r,e){var n,t,i=e-r+1,o=Array(i),u=this.x,a=this.y;for(n=r;n<=e;n++)o[n-r]=u[n];if(a){for(t=Array(i),n=r;n<=e;n++)t[n-r]=a[n];return new numeric.T(o,t)}return new numeric.T(o)},numeric.T.prototype.setRows=function(r,e,n){var t,i=this.x,o=this.y,u=n.x,a=n.y;for(t=r;t<=e;t++)i[t]=u[t-r];if(a)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),t=r;t<=e;t++)o[t]=a[t-r];else if(o)for(t=r;t<=e;t++)o[t]=numeric.rep([u[t-r].length],0);return this},numeric.T.prototype.getRow=function(r){var e=this.x,n=this.y;return n?new numeric.T(e[r],n[r]):new numeric.T(e[r])},numeric.T.prototype.setRow=function(r,e){var n=this.x,t=this.y,i=e.x,o=e.y;return n[r]=i,o?(t||(t=numeric.rep(numeric.dim(n),0),this.y=t),t[r]=o):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(r,e){var n=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(n,r,e),i(t,r,e)):new numeric.T(i(n,r,e))},numeric.T.prototype.setBlock=function(r,e,n){n instanceof numeric.T||(n=new numeric.T(n));var t=this.x,i=this.y,o=numeric.setBlock,u=n.x,a=n.y;return a?(i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(t,r,e,u),o(i,r,e,a),this):(o(t,r,e,u),void(i&&o(i,r,e,numeric.rep(numeric.dim(u),0))))},numeric.T.rep=function(r,e){var n=numeric.T;e instanceof n||(e=new n(e));var t=e.x,i=e.y,o=numeric.rep;return i?new n(o(r,t),o(r,i)):new n(o(r,t))},numeric.T.diag=function r(e){e instanceof numeric.T||(e=new numeric.T(e));var n=e.x,t=e.y,r=numeric.diag;return t?new numeric.T(r(n),r(t)):new numeric.T(r(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,e=this.x,n=this.y;return n?new r.T(r.getDiag(e),r.getDiag(n)):new r.T(r.getDiag(e))},numeric.house=function(r){var e=numeric.clone(r),n=r[0]>=0?1:-1,t=n*numeric.norm2(r);e[0]+=t;var i=numeric.norm2(e);if(0===i)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(r){var e=numeric.dim(r);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,t,i,o,u,a,c,s,f,h,l=e[0],m=numeric.clone(r),p=numeric.identity(l);for(t=0;t<l-2;t++){for(o=Array(l-t-1),n=t+1;n<l;n++)o[n-t-1]=m[n][t];if(numeric.norm2(o)>0){for(u=numeric.house(o),a=numeric.getBlock(m,[t+1,t],[l-1,l-1]),c=numeric.tensor(u,numeric.dot(u,a)),n=t+1;n<l;n++)for(s=m[n],f=c[n-t-1],i=t;i<l;i++)s[i]-=2*f[i-t];for(a=numeric.getBlock(m,[0,t+1],[l-1,l-1]),c=numeric.tensor(numeric.dot(a,u),u),n=0;n<l;n++)for(s=m[n],f=c[n],i=t+1;i<l;i++)s[i]-=2*f[i-t-1];for(a=Array(l-t-1),n=t+1;n<l;n++)a[n-t-1]=p[n];for(c=numeric.tensor(u,numeric.dot(u,a)),n=t+1;n<l;n++)for(h=p[n],f=c[n-t-1],i=0;i<l;i++)h[i]-=2*f[i]}}return{H:m,Q:p}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(r,e){"undefined"==typeof e&&(e=1e4),r=numeric.clone(r);var n,t,i,o,u,a,c,s,f,h,l,m,p,d,y,v,g,x,b=(numeric.clone(r),numeric.dim(r)),M=b[0],w=numeric.identity(M);if(M<3)return{Q:w,B:[[0,M-1]]};var _=numeric.epsilon;for(x=0;x<e;x++){for(v=0;v<M-1;v++)if(Math.abs(r[v+1][v])<_*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),e),C=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[M-1,M-1]),e);for(m=Array(v+1),y=0;y<=v;y++)m[y]=w[y];for(p=numeric.dot(A.Q,m),y=0;y<=v;y++)w[y]=p[y];for(m=Array(M-v-1),y=v+1;y<M;y++)m[y-v-1]=w[y];for(p=numeric.dot(C.Q,m),y=v+1;y<M;y++)w[y]=p[y-v-1];return{Q:w,B:A.B.concat(numeric.add(C.B,v+1))}}if(i=r[M-2][M-2],o=r[M-2][M-1],u=r[M-1][M-2],a=r[M-1][M-1],s=i+a,c=i*a-o*u,f=numeric.getBlock(r,[0,0],[2,2]),s*s>=4*c){var k,j;k=.5*(s+Math.sqrt(s*s-4*c)),j=.5*(s-Math.sqrt(s*s-4*c)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,k+j)),numeric.diag(numeric.rep([3],k*j)))}else f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,s)),numeric.diag(numeric.rep([3],c)));for(n=[f[0][0],f[1][0],f[2][0]],t=numeric.house(n),m=[r[0],r[1],r[2]],p=numeric.tensor(t,numeric.dot(t,m)),y=0;y<3;y++)for(l=r[y],d=p[y],g=0;g<M;g++)l[g]-=2*d[g];for(m=numeric.getBlock(r,[0,0],[M-1,2]),p=numeric.tensor(numeric.dot(m,t),t),y=0;y<M;y++)for(l=r[y],d=p[y],g=0;g<3;g++)l[g]-=2*d[g];for(m=[w[0],w[1],w[2]],p=numeric.tensor(t,numeric.dot(t,m)),y=0;y<3;y++)for(h=w[y],d=p[y],g=0;g<M;g++)h[g]-=2*d[g];var T;for(v=0;v<M-2;v++){for(g=v;g<=v+1;g++)if(Math.abs(r[g+1][g])<_*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){var A=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),e),C=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[M-1,M-1]),e);for(m=Array(g+1),y=0;y<=g;y++)m[y]=w[y];for(p=numeric.dot(A.Q,m),y=0;y<=g;y++)w[y]=p[y];for(m=Array(M-g-1),y=g+1;y<M;y++)m[y-g-1]=w[y];for(p=numeric.dot(C.Q,m),y=g+1;y<M;y++)w[y]=p[y-g-1];return{Q:w,B:A.B.concat(numeric.add(C.B,g+1))}}for(T=Math.min(M-1,v+3),n=Array(T-v),y=v+1;y<=T;y++)n[y-v-1]=r[y][v];for(t=numeric.house(n),m=numeric.getBlock(r,[v+1,v],[T,M-1]),p=numeric.tensor(t,numeric.dot(t,m)),y=v+1;y<=T;y++)for(l=r[y],d=p[y-v-1],g=v;g<M;g++)l[g]-=2*d[g-v];for(m=numeric.getBlock(r,[0,v+1],[M-1,T]),p=numeric.tensor(numeric.dot(m,t),t),y=0;y<M;y++)for(l=r[y],d=p[y],g=v+1;g<=T;g++)l[g]-=2*d[g-v-1];for(m=Array(T-v),y=v+1;y<=T;y++)m[y-v-1]=w[y];for(p=numeric.tensor(t,numeric.dot(t,m)),y=v+1;y<=T;y++)for(h=w[y],d=p[y-v-1],g=0;g<M;g++)h[g]-=2*d[g]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,e){var n,t,i,o,u,a,c,s,f,h,l,m,p,d,y,v,g,x=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(x.H,e),M=numeric.T,w=r.length,_=b.B,A=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),C=new M(numeric.dot(b.Q,x.Q)),k=_.length,j=Math.sqrt;for(t=0;t<k;t++)if(n=_[t][0],n===_[t][1]);else{if(o=n+1,u=A[n][n],a=A[n][o],c=A[o][n],s=A[o][o],0===a&&0===c)continue;f=-u-s,h=u*s-a*c,l=f*f-4*h,l>=0?(m=f<0?-.5*(f-j(l)):-.5*(f+j(l)),v=(u-m)*(u-m)+a*a,g=c*c+(s-m)*(s-m),v>g?(v=j(v),d=(u-m)/v,y=a/v):(g=j(g),d=c/g,y=(s-m)/g),i=new M([[y,-d],[d,y]]),C.setRows(n,o,i.dot(C.getRows(n,o)))):(m=-.5*f,p=.5*j(-l),v=(u-m)*(u-m)+a*a,g=c*c+(s-m)*(s-m),v>g?(v=j(v+p*p),d=(u-m)/v,y=a/v,m=0,p/=v):(g=j(g+p*p),d=c/g,y=(s-m)/g,m=p/g,p=0),i=new M([[y,-d],[d,y]],[[m,p],[p,-m]]),C.setRows(n,o,i.dot(C.getRows(n,o))))}var T=C.dot(r).dot(C.transjugate()),w=r.length,S=numeric.T.identity(w);for(o=0;o<w;o++)if(o>0)for(t=o-1;t>=0;t--){var P=T.get([t,t]),O=T.get([o,o]);numeric.neq(P.x,O.x)||numeric.neq(P.y,O.y)?(m=T.getRow(t).getBlock([t],[o-1]),p=S.getRow(o).getBlock([t],[o-1]),S.set([o,t],T.get([t,o]).neg().sub(m.dot(p)).div(P.sub(O)))):S.setRow(o,S.getRow(t))}for(o=0;o<w;o++)m=S.getRow(o),S.setRow(o,m.div(m.norm2()));return S=S.transpose(),S=C.transjugate().dot(S),{lambda:T.getDiag(),E:S}},numeric.ccsSparse=function(r){var e,n,t,i,o=r.length,u=[];for(t=o-1;t!==-1;--t){n=r[t];for(i in n){for(i=parseInt(i);i>=u.length;)u[u.length]=0;0!==n[i]&&u[i]++}}var e=u.length,a=Array(e+1);for(a[0]=0,t=0;t<e;++t)a[t+1]=a[t]+u[t];var c=Array(a[e]),s=Array(a[e]);for(t=o-1;t!==-1;--t){n=r[t];for(i in n)0!==n[i]&&(u[i]--,c[a[i]+u[i]]=t,s[a[i]+u[i]]=n[i])}return[a,c,s]},numeric.ccsFull=function(r){var e,n,t,i,o=r[0],u=r[1],a=r[2],c=numeric.ccsDim(r),s=c[0],f=c[1],h=numeric.rep([s,f],0);for(e=0;e<f;e++)for(t=o[e],i=o[e+1],n=t;n<i;++n)h[u[n]][e]=a[n];return h},numeric.ccsTSolve=function(r,e,n,t,i){function o(r){var e;if(0===n[r]){for(n[r]=1,e=u[r];e<u[r+1];++e)o(a[e]);i[h]=r,++h}}var u=r[0],a=r[1],c=r[2],s=u.length-1,f=Math.max,h=0;"undefined"==typeof t&&(n=numeric.rep([s],0)),"undefined"==typeof t&&(t=numeric.linspace(0,n.length-1)),"undefined"==typeof i&&(i=[]);var l,m,p,d,y,v,g;for(l=t.length-1;l!==-1;--l)o(t[l]);for(i.length=h,l=i.length-1;l!==-1;--l)n[i[l]]=0;for(l=t.length-1;l!==-1;--l)m=t[l],n[m]=e[m];for(l=i.length-1;l!==-1;--l){for(m=i[l],p=u[m],d=f(u[m+1],p),y=p;y!==d;++y)if(a[y]===m){n[m]/=c[y];break}for(g=n[m],y=p;y!==d;++y)v=a[y],v!==m&&(n[v]-=g*c[y])}return n},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,e,n,t,i,o){var u,a,c,s=0,f=i.length,h=this.k,l=this.k1,m=this.j;if(0===t[r])for(t[r]=1,m[0]=r,h[0]=a=e[r],l[0]=c=e[r+1];;)if(a>=c){if(i[f]=m[s],0===s)return;++f,--s,a=h[s],c=l[s]}else u=o[n[a]],0===t[u]?(t[u]=1,h[s]=a,++s,m[s]=u,a=e[u],l[s]=c=e[u+1]):++a},numeric.ccsLPSolve=function(r,e,n,t,i,o,u){var a,c,s,f,h,l,m,p,d,y=r[0],v=r[1],g=r[2],x=(y.length-1,e[0]),b=e[1],M=e[2];for(c=x[i],s=x[i+1],t.length=0,a=c;a<s;++a)u.dfs(o[b[a]],y,v,n,t,o);for(a=t.length-1;a!==-1;--a)n[t[a]]=0;for(a=c;a!==s;++a)f=o[b[a]],n[f]=M[a];for(a=t.length-1;a!==-1;--a){for(f=t[a],h=y[f],l=y[f+1],m=h;m<l;++m)if(o[v[m]]===f){n[f]/=g[m];break}for(d=n[f],m=h;m<l;++m)p=o[v[m]],p!==f&&(n[p]-=d*g[m])}return n},numeric.ccsLUP1=function(r,e){var n,t,i,o,u,a,c,s=r[0].length-1,f=[numeric.rep([s+1],0),[],[]],h=[numeric.rep([s+1],0),[],[]],l=f[0],m=f[1],p=f[2],d=h[0],y=h[1],v=h[2],g=numeric.rep([s],0),x=numeric.rep([s],0),b=numeric.ccsLPSolve,M=(Math.max,Math.abs),w=numeric.linspace(0,s-1),_=numeric.linspace(0,s-1),A=new numeric.ccsDFS(s);for("undefined"==typeof e&&(e=1),n=0;n<s;++n){for(b(f,r,g,x,n,_,A),o=-1,u=-1,t=x.length-1;t!==-1;--t)i=x[t],i<=n||(a=M(g[i]),a>o&&(u=i,o=a));for(M(g[n])<e*o&&(t=w[n],o=w[u],w[n]=o,_[o]=n,w[u]=t,_[t]=u,o=g[n],g[n]=g[u],g[u]=o),o=l[n],u=d[n],c=g[n],m[o]=w[n],p[o]=1,++o,t=x.length-1;t!==-1;--t)i=x[t],a=g[i],x[t]=0,g[i]=0,i<=n?(y[u]=i,v[u]=a,++u):(m[o]=w[i],p[o]=a/c,++o);l[n+1]=o,d[n+1]=u}for(t=m.length-1;t!==-1;--t)m[t]=_[m[t]];return{L:f,U:h,P:w,Pinv:_}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,e,n,t,i,o,u){var a,c,s,f=0,h=i.length,l=this.k,m=this.k1,p=this.j;if(0===t[r])for(t[r]=1,p[0]=r,l[0]=c=e[o[r]],m[0]=s=e[o[r]+1];;){if(isNaN(c))throw new Error("Ow!");if(c>=s){if(i[h]=o[p[f]],0===f)return;++h,--f,c=l[f],s=m[f]}else a=n[c],0===t[a]?(t[a]=1,l[f]=c,++f,p[f]=a,a=o[a],c=e[a],m[f]=s=e[a+1]):++c}},numeric.ccsLPSolve0=function(r,e,n,t,i,o,u,a){var c,s,f,h,l,m,p,d,y,v=r[0],g=r[1],x=r[2],b=(v.length-1,e[0]),M=e[1],w=e[2];for(s=b[i],f=b[i+1],t.length=0,c=s;c<f;++c)a.dfs(M[c],v,g,n,t,o,u);for(c=t.length-1;c!==-1;--c)h=t[c],n[u[h]]=0;for(c=s;c!==f;++c)h=M[c],n[h]=w[c];for(c=t.length-1;c!==-1;--c){for(h=t[c],d=u[h],l=v[h],m=v[h+1],p=l;p<m;++p)if(g[p]===d){n[d]/=x[p];break}for(y=n[d],p=l;p<m;++p)n[g[p]]-=y*x[p];n[d]=y}},numeric.ccsLUP0=function(r,e){var n,t,i,o,u,a,c,s=r[0].length-1,f=[numeric.rep([s+1],0),[],[]],h=[numeric.rep([s+1],0),[],[]],l=f[0],m=f[1],p=f[2],d=h[0],y=h[1],v=h[2],g=numeric.rep([s],0),x=numeric.rep([s],0),b=numeric.ccsLPSolve0,M=(Math.max,Math.abs),w=numeric.linspace(0,s-1),_=numeric.linspace(0,s-1),A=new numeric.ccsDFS0(s);for("undefined"==typeof e&&(e=1),n=0;n<s;++n){for(b(f,r,g,x,n,_,w,A),o=-1,u=-1,t=x.length-1;t!==-1;--t)i=x[t],i<=n||(a=M(g[w[i]]),a>o&&(u=i,o=a));for(M(g[w[n]])<e*o&&(t=w[n],o=w[u],w[n]=o,_[o]=n,w[u]=t,_[t]=u),o=l[n],u=d[n],c=g[w[n]],m[o]=w[n],p[o]=1,++o,t=x.length-1;t!==-1;--t)i=x[t],a=g[w[i]],x[t]=0,g[w[i]]=0,i<=n?(y[u]=i,v[u]=a,++u):(m[o]=w[i],p[o]=a/c,++o);l[n+1]=o,d[n+1]=u}for(t=m.length-1;t!==-1;--t)m[t]=_[m[t]];return{L:f,U:h,P:w,Pinv:_}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,e,n){var t=numeric.ccsDim(r),i=t[0],o=t[1];"undefined"==typeof e?e=numeric.linspace(0,i-1):"number"==typeof e&&(e=[e]),"undefined"==typeof n?n=numeric.linspace(0,o-1):"number"==typeof n&&(n=[n]);var u,a,c,s,f,h=e.length,l=n.length,m=numeric.rep([o],0),p=[],d=[],y=[m,p,d],v=r[0],g=r[1],x=r[2],b=numeric.rep([i],0),M=0,w=numeric.rep([i],0);for(a=0;a<l;++a){s=n[a];var _=v[s],A=v[s+1];for(u=_;u<A;++u)c=g[u],w[c]=1,b[c]=x[u];for(u=0;u<h;++u)f=e[u],w[f]&&(p[M]=u,d[M]=b[e[u]],++M);for(u=_;u<A;++u)c=g[u],w[c]=0;m[a+1]=M}return y},numeric.ccsDot=function(r,e){var n,t,i,o,u,a,c,s,f,h,l,m=r[0],p=r[1],d=r[2],y=e[0],v=e[1],g=e[2],x=numeric.ccsDim(r),b=numeric.ccsDim(e),M=x[0],w=(x[1],b[1]),_=numeric.rep([M],0),A=numeric.rep([M],0),C=Array(M),k=numeric.rep([w],0),j=[],T=[],S=[k,j,T];for(i=0;i!==w;++i){for(o=y[i],u=y[i+1],f=0,t=o;t<u;++t)for(h=v[t],l=g[t],a=m[h],c=m[h+1],n=a;n<c;++n)s=p[n],0===A[s]&&(C[f]=s,A[s]=1,f+=1),_[s]=_[s]+d[n]*l;for(o=k[i],u=o+f,k[i+1]=u,t=f-1;t!==-1;--t)l=o+t,n=C[t],j[l]=n,T[l]=_[n],A[n]=0,_[n]=0;k[i+1]=k[i]+f}return S},numeric.ccsLUPSolve=function(r,e){var n=r.L,t=r.U,i=(r.P,e[0]),o=!1;"object"!=typeof i&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],i=e[0],o=!0);var u,a,c,s,f,h,l=e[1],m=e[2],p=n[0].length-1,d=i.length-1,y=numeric.rep([p],0),v=Array(p),g=numeric.rep([p],0),x=Array(p),b=numeric.rep([d+1],0),M=[],w=[],_=numeric.ccsTSolve,A=0;for(u=0;u<d;++u){for(f=0,c=i[u],s=i[u+1],a=c;a<s;++a)h=r.Pinv[l[a]],x[f]=h,g[h]=m[a],++f;for(x.length=f,_(n,g,y,x,v),a=x.length-1;a!==-1;--a)g[x[a]]=0;if(_(t,y,g,v,x),o)return g;for(a=v.length-1;a!==-1;--a)y[v[a]]=0;for(a=x.length-1;a!==-1;--a)h=x[a],M[A]=h,w[A]=g[h],g[h]=0,++A;b[u+1]=A}return[b,M,w]},numeric.ccsbinop=function(r,e){return"undefined"==typeof e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var e,n=r[0],t=r[1],i=r[2],o=numeric.sup(t)+1,u=n.length,a=numeric.rep([o],0),c=Array(u),s=Array(u),f=numeric.rep([o],0);for(e=0;e<u;++e)f[t[e]]++;for(e=0;e<o;++e)a[e+1]=a[e]+f[e];var h,l,m=a.slice(0);for(e=0;e<u;++e)l=t[e],h=m[l],c[h]=n[e],s[h]=i[e],m[l]=m[l]+1;return[a,c,s]},numeric.ccsGather=function(r){var e,n,t,i,o,u=r[0],a=r[1],c=r[2],s=u.length-1,f=a.length,h=Array(f),l=Array(f),m=Array(f);
for(o=0,e=0;e<s;++e)for(t=u[e],i=u[e+1],n=t;n!==i;++n)l[o]=e,h[o]=a[n],m[o]=c[n],++o;return[h,l,m]},numeric.sdim=function r(e,n,t){if("undefined"==typeof n&&(n=[]),"object"!=typeof e)return n;"undefined"==typeof t&&(t=0),t in n||(n[t]=0),e.length>n[t]&&(n[t]=e.length);var i;for(i in e)e.hasOwnProperty(i)&&r(e[i],n,t+1);return n},numeric.sclone=function r(e,n,t){"undefined"==typeof n&&(n=0),"undefined"==typeof t&&(t=numeric.sdim(e).length);var i,o=Array(e.length);if(n===t-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=r(e[i],n+1,t));return o},numeric.sdiag=function(r){var e,n,t=r.length,i=Array(t);for(e=t-1;e>=1;e-=2)n=e-1,i[e]=[],i[e][e]=r[e],i[n]=[],i[n][n]=r[n];return 0===e&&(i[0]=[],i[0][0]=r[e]),i},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var e,n,t,i=[];r.length;for(e in r)if(r.hasOwnProperty(e)){t=r[e];for(n in t)t.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][e]=t[n])}return i},numeric.sLUP=function(r,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,e){var n,t,i,o,u,a,c,s=r.length,f=(e.length,numeric.stranspose(e)),h=f.length,l=Array(s);for(i=s-1;i>=0;i--){for(c=[],n=r[i],u=h-1;u>=0;u--){a=0,t=f[u];for(o in n)n.hasOwnProperty(o)&&o in t&&(a+=n[o]*t[o]);a&&(c[u]=a)}l[i]=c}return l},numeric.sdotMV=function(r,e){var n,t,i,o,u=r.length,a=Array(u);for(t=u-1;t>=0;t--){n=r[t],o=0;for(i in n)n.hasOwnProperty(i)&&e[i]&&(o+=n[i]*e[i]);o&&(a[t]=o)}return a},numeric.sdotVM=function(r,e){var n,t,i,o,u=[];for(n in r)if(r.hasOwnProperty(n)){i=e[n],o=r[n];for(t in i)i.hasOwnProperty(t)&&(u[t]||(u[t]=0),u[t]+=o*i[t])}return u},numeric.sdotVV=function(r,e){var n,t=0;for(n in r)r[n]&&e[n]&&(t+=r[n]*e[n]);return t},numeric.sdot=function(r,e){var n=numeric.sdim(r).length,t=numeric.sdim(e).length,i=1e3*n+t;switch(i){case 0:return r*e;case 1001:return numeric.sdotVV(r,e);case 2001:return numeric.sdotMV(r,e);case 1002:return numeric.sdotVM(r,e);case 2002:return numeric.sdotMM(r,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+t)}},numeric.sscatter=function(r){var e,n,t,i,o=r[0].length,u=r.length,a=[];for(n=o-1;n>=0;--n)if(r[u-1][n]){for(i=a,t=0;t<u-2;t++)e=r[t][n],i[e]||(i[e]=[]),i=i[e];i[r[t][n]]=r[t+1][n]}return a},numeric.sgather=function r(e,n,t){"undefined"==typeof n&&(n=[]),"undefined"==typeof t&&(t=[]);var i,o,u;i=t.length;for(o in e)if(e.hasOwnProperty(o))if(t[i]=parseInt(o),u=e[o],"number"==typeof u){if(u){if(0===n.length)for(o=i+1;o>=0;--o)n[o]=[];for(o=i;o>=0;--o)n[o].push(t[o]);n[i+1].push(u)}}else r(u,n,t);return t.length>i&&t.pop(),n},numeric.cLU=function(r){var e,n,t,i,o,u,a=r[0],c=r[1],s=r[2],f=a.length,h=0;for(e=0;e<f;e++)a[e]>h&&(h=a[e]);h++;var l,m,p,d=Array(h),y=Array(h),v=numeric.rep([h],1/0),g=numeric.rep([h],-(1/0));for(t=0;t<f;t++)e=a[t],n=c[t],n<v[e]&&(v[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)v[e]<v[e-1]&&(v[e-1]=v[e]);var x=0,b=0;for(e=0;e<h;e++)y[e]=numeric.rep([g[e]-v[e]+1],0),d[e]=numeric.rep([e-v[e]],0),x+=e-v[e]+1,b+=g[e]-e+1;for(t=0;t<f;t++)e=a[t],y[e][c[t]-v[e]]=s[t];for(e=0;e<h-1;e++)for(i=e-v[e],l=y[e],n=e+1;v[n]<=e&&n<h;n++)if(o=e-v[n],u=g[e]-e,m=y[n],p=m[o]/l[i]){for(t=1;t<=u;t++)m[t+o]-=p*l[t+i];d[n][e-v[n]]=p}var f,M,w,l=[],m=[],_=[],A=[],C=[],k=[];for(f=0,M=0,e=0;e<h;e++){for(i=v[e],o=g[e],w=y[e],n=e;n<=o;n++)w[n-i]&&(l[f]=e,m[f]=n,_[f]=w[n-i],f++);for(w=d[e],n=i;n<e;n++)w[n-i]&&(A[M]=e,C[M]=n,k[M]=w[n-i],M++);A[M]=e,C[M]=e,k[M]=1,M++}return{U:[l,m,_],L:[A,C,k]}},numeric.cLUsolve=function(r,e){var n,t,i=r.L,o=r.U,u=numeric.clone(e),a=i[0],c=i[1],s=i[2],f=o[0],h=o[1],l=o[2],m=f.length,p=(a.length,u.length);for(t=0,n=0;n<p;n++){for(;c[t]<n;)u[n]-=s[t]*u[c[t]],t++;t++}for(t=m-1,n=p-1;n>=0;n--){for(;h[t]>n;)u[n]-=l[t]*u[h[t]],t--;u[n]/=l[t],t--}return u},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var n,t,i,o=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,n){return e>=r[0]/2||n<r[1]/2};break;default:e=function(r,e){return!0}}for(i=0,n=1;n<r[0]-1;n++)for(t=1;t<r[1]-1;t++)e(n,t)&&(o[n][t]=i,i++);return o},numeric.cdelsq=function(r){var e,n,t,i,o,u=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(r),c=a[0],s=a[1],f=[],h=[],l=[];for(e=1;e<c-1;e++)for(n=1;n<s-1;n++)if(!(r[e][n]<0)){for(t=0;t<4;t++)i=e+u[t][0],o=n+u[t][1],r[i][o]<0||(f.push(r[e][n]),h.push(r[i][o]),l.push(-1));f.push(r[e][n]),h.push(r[e][n]),l.push(4)}return[f,h,l]},numeric.cdotMV=function(r,e){var n,t,i,o=r[0],u=r[1],a=r[2],c=o.length;for(i=0,t=0;t<c;t++)o[t]>i&&(i=o[t]);for(i++,n=numeric.rep([i],0),t=0;t<c;t++)n[o[t]]+=a[t]*e[u[t]];return n},numeric.Spline=function(r,e,n,t,i){this.x=r,this.yl=e,this.yr=n,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(r,e){var r,n,t,i,o=this.x,u=this.yl,a=this.yr,c=this.kl,s=this.kr,f=numeric.add,h=numeric.sub,l=numeric.mul;n=h(l(c[e],o[e+1]-o[e]),h(a[e+1],u[e])),t=f(l(s[e+1],o[e]-o[e+1]),h(a[e+1],u[e])),i=(r-o[e])/(o[e+1]-o[e]);var m=i*(1-i);return f(f(f(l(1-i,u[e]),l(i,a[e+1])),l(n,m*(1-i))),l(t,m*i))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var e,n,t,i=this.x,o=i.length,u=Math.floor;for(e=0,n=o-1;n-e>1;)t=u((e+n)/2),i[t]<=r?e=t:n=t;return this._at(r,e)}var a,o=r.length,c=Array(o);for(a=o-1;a!==-1;--a)c[a]=this.at(r[a]);return c},numeric.Spline.prototype.diff=function(){var r,e,n,t=this.x,i=this.yl,o=this.yr,u=this.kl,a=this.kr,c=i.length,s=u,f=a,h=Array(c),l=Array(c),m=numeric.add,p=numeric.mul,d=numeric.div,y=numeric.sub;for(r=c-1;r!==-1;--r)e=t[r+1]-t[r],n=y(o[r+1],i[r]),h[r]=d(m(p(n,6),p(u[r],-4*e),p(a[r+1],-2*e)),e*e),l[r+1]=d(m(p(n,-6),p(u[r],2*e),p(a[r+1],4*e)),e*e);return new numeric.Spline(t,s,f,h,l)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var e=[],n=this.x,t=this.yl,i=this.yr,o=this.kl,u=this.kr;"number"==typeof t[0]&&(t=[t],i=[i],o=[o],u=[u]);var a,c,s,f,h,l,m,p,d,y,v,g,x,b,M,w,_,A,C,k,j,T,S,P,O=t.length,q=n.length-1,e=Array(O),F=Math.sqrt;for(a=0;a!==O;++a){for(f=t[a],h=i[a],l=o[a],m=u[a],p=[],c=0;c!==q;c++){for(c>0&&h[c]*f[c]<0&&p.push(n[c]),w=n[c+1]-n[c],_=n[c],v=f[c],g=h[c+1],d=l[c]/w,y=m[c+1]/w,M=r(d-y+3*(v-g))+12*y*v,x=y+3*v+2*d-3*g,b=3*(y+d+2*(v-g)),M<=0?(C=x/b,A=C>n[c]&&C<n[c+1]?[n[c],C,n[c+1]]:[n[c],n[c+1]]):(C=(x-F(M))/b,k=(x+F(M))/b,A=[n[c]],C>n[c]&&C<n[c+1]&&A.push(C),k>n[c]&&k<n[c+1]&&A.push(k),A.push(n[c+1])),T=A[0],C=this._at(T,c),s=0;s<A.length-1;s++)if(S=A[s+1],k=this._at(S,c),0!==C)if(0===k||C*k>0)T=S,C=k;else{for(var B=0;;){if(P=(C*S-k*T)/(C-k),P<=T||P>=S)break;if(j=this._at(P,c),j*k>0)S=P,k=j,B===-1&&(C*=.5),B=-1;else{if(!(j*C>0))break;T=P,C=j,1===B&&(k*=.5),B=1}}p.push(P),T=A[s+1],C=this._at(T,c)}else p.push(T),T=S,C=k;0===k&&p.push(S)}e[a]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(r,e,n,t){var i,o=r.length,u=[],a=[],c=[],s=numeric.sub,f=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)a[i]=r[i+1]-r[i],c[i]=s(e[i+1],e[i]);"string"!=typeof n&&"string"!=typeof t||(n=t="periodic");var l=[[],[],[]];switch(typeof n){case"undefined":u[0]=f(3/(a[0]*a[0]),c[0]),l[0].push(0,0),l[1].push(0,1),l[2].push(2/a[0],1/a[0]);break;case"string":u[0]=h(f(3/(a[o-2]*a[o-2]),c[o-2]),f(3/(a[0]*a[0]),c[0])),l[0].push(0,0,0),l[1].push(o-2,0,1),l[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:u[0]=n,l[0].push(0),l[1].push(0),l[2].push(1)}for(i=1;i<o-1;i++)u[i]=h(f(3/(a[i-1]*a[i-1]),c[i-1]),f(3/(a[i]*a[i]),c[i])),l[0].push(i,i,i),l[1].push(i-1,i,i+1),l[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof t){case"undefined":u[o-1]=f(3/(a[o-2]*a[o-2]),c[o-2]),l[0].push(o-1,o-1),l[1].push(o-2,o-1),l[2].push(1/a[o-2],2/a[o-2]);break;case"string":l[1][l[1].length-1]=0;break;default:u[o-1]=t,l[0].push(o-1),l[1].push(o-1),l[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var m=Array(u.length);if("string"==typeof n)for(i=m.length-1;i!==-1;--i)m[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(l)),u[i]),m[i][o-1]=m[i][0];else for(i=m.length-1;i!==-1;--i)m[i]=numeric.cLUsolve(numeric.cLU(l),u[i]);return m="number"==typeof e[0]?m[0]:numeric.transpose(m),new numeric.Spline(r,e,e,m,m)},numeric.fftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,a=Math.sin,c=Array(t/2),s=Array(t/2),f=Array(t/2),h=Array(t/2);for(o=t/2,i=t-1;i!==-1;--i)--o,f[o]=e[i],h[o]=n[i],--i,c[o]=e[i],s[o]=n[i];r(c,s),r(f,h),o=t/2;var l,m,p,d=-6.283185307179586/t;for(i=t-1;i!==-1;--i)--o,o===-1&&(o=t/2-1),l=d*i,m=u(l),p=a(l),e[i]=c[o]+m*f[o]-p*h[o],n[i]=s[o]+m*h[o]+p*f[o]}},numeric._ifftpow2=function r(e,n){var t=e.length;if(1!==t){var i,o,u=Math.cos,a=Math.sin,c=Array(t/2),s=Array(t/2),f=Array(t/2),h=Array(t/2);for(o=t/2,i=t-1;i!==-1;--i)--o,f[o]=e[i],h[o]=n[i],--i,c[o]=e[i],s[o]=n[i];r(c,s),r(f,h),o=t/2;var l,m,p,d=6.283185307179586/t;for(i=t-1;i!==-1;--i)--o,o===-1&&(o=t/2-1),l=d*i,m=u(l),p=a(l),e[i]=c[o]+m*f[o]-p*h[o],n[i]=s[o]+m*h[o]+p*f[o]}},numeric.ifftpow2=function(r,e){numeric._ifftpow2(r,e),numeric.diveq(r,r.length),numeric.diveq(e,e.length)},numeric.convpow2=function(r,e,n,t){numeric.fftpow2(r,e),numeric.fftpow2(n,t);var i,o,u,a,c,s=r.length;for(i=s-1;i!==-1;--i)o=r[i],a=e[i],u=n[i],c=t[i],r[i]=o*u-a*c,e[i]=o*c+a*u;numeric.ifftpow2(r,e)},numeric.T.prototype.fft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),a=Math.ceil(o(2*i-1)/u),c=Math.pow(2,a),s=numeric.rep([c],0),f=numeric.rep([c],0),h=Math.cos,l=Math.sin,m=-3.141592653589793/i,p=numeric.rep([c],0),d=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if("undefined"!=typeof t)for(r=0;r<i;r++)d[r]=t[r];for(s[0]=1,r=1;r<=c/2;r++)e=m*r*r,s[r]=h(e),f[r]=l(e),s[c-r]=h(e),f[c-r]=l(e);var y=new numeric.T(p,d),v=new numeric.T(s,f);return y=y.mul(v),numeric.convpow2(y.x,y.y,numeric.clone(v.x),numeric.neg(v.y)),y=y.mul(v),y.x.length=i,y.y.length=i,y},numeric.T.prototype.ifft=function(){var r,e,n=this.x,t=this.y,i=n.length,o=Math.log,u=o(2),a=Math.ceil(o(2*i-1)/u),c=Math.pow(2,a),s=numeric.rep([c],0),f=numeric.rep([c],0),h=Math.cos,l=Math.sin,m=3.141592653589793/i,p=numeric.rep([c],0),d=numeric.rep([c],0);Math.floor(i/2);for(r=0;r<i;r++)p[r]=n[r];if("undefined"!=typeof t)for(r=0;r<i;r++)d[r]=t[r];for(s[0]=1,r=1;r<=c/2;r++)e=m*r*r,s[r]=h(e),f[r]=l(e),s[c-r]=h(e),f[c-r]=l(e);var y=new numeric.T(p,d),v=new numeric.T(s,f);return y=y.mul(v),numeric.convpow2(y.x,y.y,numeric.clone(v.x),numeric.neg(v.y)),y=y.mul(v),y.x.length=i,y.y.length=i,y.div(i)},numeric.gradient=function(r,e){var n=e.length,t=r(e);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var i,o,u,a,c,s,f,h,l,m,p=Math.max,d=numeric.clone(e),y=Array(n),p=(numeric.div,numeric.sub,Math.max),v=.001,g=Math.abs,x=Math.min,b=0;for(i=0;i<n;i++)for(var M=p(1e-6*t,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(d[i]=e[i]+M,o=r(d),d[i]=e[i]-M,u=r(d),d[i]=e[i],isNaN(o)||isNaN(u))M/=16;else{if(y[i]=(o-u)/(2*M),c=e[i]-M,s=e[i],f=e[i]+M,h=(o-t)/M,l=(t-u)/M,m=p(g(y[i]),g(t),g(o),g(u),g(c),g(s),g(f),1e-8),a=x(p(g(h-y[i]),g(l-y[i]),g(h-l))/m,M/m),!(a>v))break;M/=16}}return y},numeric.uncmin=function(r,e,n,t,i,o,u){var a=numeric.gradient;"undefined"==typeof u&&(u={}),"undefined"==typeof n&&(n=1e-8),"undefined"==typeof t&&(t=function(e){return a(r,e)}),"undefined"==typeof i&&(i=1e3),e=numeric.clone(e);var c,s,f=e.length,h=r(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var l=Math.max,m=numeric.norm2;n=l(n,numeric.epsilon);var p,d,y,v,g,x,b,M,w,_,A=u.Hinv||numeric.identity(f),C=numeric.dot,k=(numeric.inv,numeric.sub),j=numeric.add,T=numeric.tensor,S=numeric.div,P=numeric.mul,O=numeric.all,q=numeric.isFinite,F=numeric.neg,B=0,N="";for(d=t(e);B<i;){if("function"==typeof o&&o(B,e,h,d,A)){N="Callback returned true";break}if(!O(q(d))){N="Gradient has Infinity or NaN";break}if(p=F(C(A,d)),!O(q(p))){N="Search direction has Infinity or NaN";break}if(_=m(p),_<n){N="Newton step smaller than tol";break}for(w=1,s=C(d,p),g=e;B<i&&!(w*_<n)&&(v=P(p,w),g=j(e,v),c=r(g),c-h>=.1*w*s||isNaN(c));)w*=.5,++B;if(w*_<n){N="Line search step size smaller than tol";break}if(B===i){N="maxit reached during line search";break}y=t(g),x=k(y,d),M=C(x,v),b=C(A,x),A=k(j(A,P((M+C(x,b))/(M*M),T(v,v))),S(j(T(b,v),T(v,b)),M)),e=g,h=c,d=y,++B}return{solution:e,f:h,gradient:d,invHessian:A,iterations:B,message:N}},numeric.Dopri=function(r,e,n,t,i,o,u){this.x=r,this.y=e,this.f=n,this.ymid=t,this.iterations=i,this.events=u,this.message=o},numeric.Dopri.prototype._at=function(r,e){function n(r){return r*r}var t,i,o,u,a,c,r,s,f,h,l,m=this,p=m.x,d=m.y,y=m.f,v=m.ymid,g=(p.length,Math.floor,.5),x=numeric.add,b=numeric.mul,M=numeric.sub;return t=p[e],i=p[e+1],u=d[e],a=d[e+1],s=i-t,o=t+g*s,c=v[e],f=M(y[e],b(u,1/(t-o)+2/(t-i))),h=M(y[e+1],b(a,1/(i-o)+2/(i-t))),l=[n(r-i)*(r-o)/n(t-i)/(t-o),n(r-t)*n(r-i)/n(t-o)/n(i-o),n(r-t)*(r-o)/n(i-t)/(i-o),(r-t)*n(r-i)*(r-o)/n(t-i)/(t-o),(r-i)*n(r-t)*(r-o)/n(t-i)/(i-o)],x(x(x(x(b(u,l[0]),b(c,l[1])),b(a,l[2])),b(f,l[3])),b(h,l[4]))},numeric.Dopri.prototype.at=function(r){var e,n,t,i=Math.floor;if("number"!=typeof r){var o=r.length,u=Array(o);for(e=o-1;e!==-1;--e)u[e]=this.at(r[e]);return u}var a=this.x;for(e=0,n=a.length-1;n-e>1;)t=i(.5*(e+n)),a[t]<=r?e=t:n=t;return this._at(r,e)},numeric.dopri=function(r,e,n,t,i,o,u){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof o&&(o=1e3);var a,c,s,f,h,l,m,p,d,y,v,g,x,b=[r],M=[n],w=[t(r,n)],_=[],A=.2,C=[.075,.225],k=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],T=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],S=[35/384,0,500/1113,125/192,-2187/6784,11/84],P=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],O=[.2,.3,.8,8/9,1,1],q=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],F=0,B=(e-r)/10,N=0,V=numeric.add,L=numeric.mul,D=(Math.max,Math.min),R=Math.abs,H=numeric.norminf,z=Math.pow,G=numeric.any,U=numeric.lt,I=numeric.and,E=(numeric.sub,new numeric.Dopri(b,M,w,_,(-1),""));for("function"==typeof u&&(v=u(r,n));r<e&&N<o;)if(++N,r+B>e&&(B=e-r),a=t(r+O[0]*B,V(n,L(A*B,w[F]))),c=t(r+O[1]*B,V(V(n,L(C[0]*B,w[F])),L(C[1]*B,a))),s=t(r+O[2]*B,V(V(V(n,L(k[0]*B,w[F])),L(k[1]*B,a)),L(k[2]*B,c))),f=t(r+O[3]*B,V(V(V(V(n,L(j[0]*B,w[F])),L(j[1]*B,a)),L(j[2]*B,c)),L(j[3]*B,s))),h=t(r+O[4]*B,V(V(V(V(V(n,L(T[0]*B,w[F])),L(T[1]*B,a)),L(T[2]*B,c)),L(T[3]*B,s)),L(T[4]*B,f))),d=V(V(V(V(V(n,L(w[F],B*S[0])),L(c,B*S[2])),L(s,B*S[3])),L(f,B*S[4])),L(h,B*S[5])),l=t(r+B,d),m=V(V(V(V(V(L(w[F],B*q[0]),L(c,B*q[2])),L(s,B*q[3])),L(f,B*q[4])),L(h,B*q[5])),L(l,B*q[6])),y="number"==typeof m?R(m):H(m),y>i){if(B=.2*B*z(i/y,.25),r+B===r){E.msg="Step size became too small";break}}else{if(_[F]=V(V(V(V(V(V(n,L(w[F],B*P[0])),L(c,B*P[2])),L(s,B*P[3])),L(f,B*P[4])),L(h,B*P[5])),L(l,B*P[6])),++F,b[F]=r+B,M[F]=d,w[F]=l,"function"==typeof u){var X,Y,Q=r,Z=r+.5*B;if(g=u(Z,_[F-1]),x=I(U(v,0),U(0,g)),G(x)||(Q=Z,Z=r+B,v=g,g=u(Z,d),x=I(U(v,0),U(0,g))),G(x)){for(var W,$,J=0,K=1,rr=1;;){if("number"==typeof v)Y=(rr*g*Q-K*v*Z)/(rr*g-K*v);else for(Y=Z,p=v.length-1;p!==-1;--p)v[p]<0&&g[p]>0&&(Y=D(Y,(rr*g[p]*Q-K*v[p]*Z)/(rr*g[p]-K*v[p])));if(Y<=Q||Y>=Z)break;X=E._at(Y,F-1),$=u(Y,X),W=I(U(v,0),U(0,$)),G(W)?(Z=Y,g=$,x=W,rr=1,J===-1?K*=.5:K=1,J=-1):(Q=Y,v=$,K=1,1===J?rr*=.5:rr=1,J=1)}return d=E._at(.5*(r+Y),F-1),E.f[F]=t(Y,X),E.x[F]=Y,E.y[F]=X,E.ymid[F-1]=d,E.events=x,E.iterations=N,E}}r+=B,n=d,v=g,B=D(.8*B*z(i/y,.25),4*B)}return E.iterations=N,E},numeric.LU=function(r,e){e=e||!1;var n,t,i,o,u,a,c,s,f,h=Math.abs,l=r.length,m=l-1,p=new Array(l);for(e||(r=numeric.clone(r)),i=0;i<l;++i){for(c=i,a=r[i],f=h(a[i]),t=i+1;t<l;++t)o=h(r[t][i]),f<o&&(f=o,c=t);for(p[i]=c,c!=i&&(r[i]=r[c],r[c]=a,a=r[i]),u=a[i],n=i+1;n<l;++n)r[n][i]/=u;for(n=i+1;n<l;++n){for(s=r[n],t=i+1;t<m;++t)s[t]-=s[i]*a[t],++t,s[t]-=s[i]*a[t];t===m&&(s[t]-=s[i]*a[t])}}return{LU:r,P:p}},numeric.LUsolve=function(r,e){var n,t,i,o,u,a=r.LU,c=a.length,s=numeric.clone(e),f=r.P;for(n=c-1;n!==-1;--n)s[n]=e[n];for(n=0;n<c;++n)for(i=f[n],f[n]!==n&&(u=s[n],s[n]=s[i],s[i]=u),o=a[n],t=0;t<n;++t)s[n]-=s[t]*o[t];for(n=c-1;n>=0;--n){for(o=a[n],t=n+1;t<c;++t)s[n]-=s[t]*o[t];s[n]/=o[n]}return s},numeric.solve=function(r,e,n){return numeric.LUsolve(numeric.LU(r,n),e)},numeric.echelonize=function(r){var e,n,t,i,o,u,a,c,s=numeric.dim(r),f=s[0],h=s[1],l=numeric.identity(f),m=Array(f),p=Math.abs,d=numeric.diveq;for(r=numeric.clone(r),e=0;e<f;++e){for(t=0,o=r[e],u=l[e],n=1;n<h;++n)p(o[t])<p(o[n])&&(t=n);for(m[e]=t,d(u,o[t]),d(o,o[t]),n=0;n<f;++n)if(n!==e){for(a=r[n],c=a[t],i=h-1;i!==-1;--i)a[i]-=o[i]*c;for(a=l[n],i=f-1;i!==-1;--i)a[i]-=u[i]*c}}return{I:l,A:r,P:m}},numeric.__solveLP=function(r,e,n,t,i,o,u){var a,c,s,f,h=numeric.sum,l=(numeric.log,numeric.mul),m=numeric.sub,p=numeric.dot,d=numeric.div,y=numeric.add,v=r.length,g=n.length,x=!1,b=0,M=1,w=(numeric.transpose(e),numeric.svd,numeric.transpose),_=(numeric.leq,Math.sqrt),A=Math.abs,C=(numeric.muleq,numeric.norminf,numeric.any,Math.min),k=numeric.all,j=numeric.gt,T=Array(v),S=Array(g),P=(numeric.rep([g],1),numeric.solve),O=m(n,p(e,o)),q=p(r,r);for(s=b;s<i;++s){var F,B;for(F=g-1;F!==-1;--F)S[F]=d(e[F],O[F]);var N=w(S);for(F=v-1;F!==-1;--F)T[F]=h(N[F]);M=.25*A(q/p(r,T));var V=100*_(q/p(T,T));for((!isFinite(M)||M>V)&&(M=V),f=y(r,l(M,T)),c=p(N,S),F=v-1;F!==-1;--F)c[F][F]+=1;B=P(c,d(f,M),!0);var L=d(O,p(e,B)),D=1;for(F=g-1;F!==-1;--F)L[F]<0&&(D=C(D,-.999*L[F]));if(a=m(o,l(B,D)),O=m(n,p(e,a)),!k(j(O,0)))return{solution:o,message:"",iterations:s};if(o=a,M<t)return{solution:a,message:"",iterations:s};if(u){var R=p(r,f),H=p(e,f);for(x=!0,F=g-1;F!==-1;--F)if(R*H[F]<0){x=!1;break}}else x=!(o[v-1]>=0);if(x)return{solution:a,message:"Unbounded",iterations:s}}return{solution:o,message:"maximum iteration count exceeded",iterations:s}},numeric._solveLP=function(r,e,n,t,i){var o,u=r.length,a=n.length,c=(numeric.sum,numeric.log,numeric.mul,numeric.sub),s=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([u],0).concat([1])),h=numeric.rep([a,1],-1),l=numeric.blockMatrix([[e,h]]),m=n,o=numeric.rep([u],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(f,l,m,t,i,o,!1),d=numeric.clone(p.solution);d.length=u;var y=numeric.inf(c(n,s(e,d)));if(y<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var v=numeric.__solveLP(r,e,n,t,i-p.iterations,d,!0);return v.iterations+=p.iterations,v},numeric.solveLP=function(r,e,n,t,i,o,u){if("undefined"==typeof u&&(u=1e3),"undefined"==typeof o&&(o=numeric.epsilon),"undefined"==typeof t)return numeric._solveLP(r,e,n,o,u);var a,c=t.length,s=t[0].length,f=e.length,h=numeric.echelonize(t),l=numeric.rep([s],0),m=h.P,p=[];for(a=m.length-1;a!==-1;--a)l[m[a]]=1;for(a=s-1;a!==-1;--a)0===l[a]&&p.push(a);var d=numeric.getRange,y=numeric.linspace(0,c-1),v=numeric.linspace(0,f-1),g=d(t,y,p),x=d(e,v,m),b=d(e,v,p),M=numeric.dot,w=numeric.sub,_=M(x,h.I),A=w(b,M(_,g)),C=w(n,M(_,i)),k=Array(m.length),j=Array(p.length);for(a=m.length-1;a!==-1;--a)k[a]=r[m[a]];for(a=p.length-1;a!==-1;--a)j[a]=r[p[a]];var T=w(j,M(k,M(h.I,g))),S=numeric._solveLP(T,A,C,o,u),P=S.solution;if(P!==P)return S;var O=M(h.I,w(i,M(g,P))),q=Array(r.length);for(a=m.length-1;a!==-1;--a)q[m[a]]=O[a];for(a=p.length-1;a!==-1;--a)q[p[a]]=P[a];return{solution:q,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(r){function e(e){throw new Error("MPStoLP: "+e+"\nLine "+n+": "+r[n]+"\nCurrent state: "+a[u]+"\n")}r instanceof String&&r.split("\n");var n,t,i,o,u=0,a=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],c=r.length,s=0,f={},h=[],l=0,m={},p=0,d=[],y=[],v=[];for(n=0;n<c;++n){i=r[n];var g=i.match(/\S*/g),x=[];for(t=0;t<g.length;++t)""!==g[t]&&x.push(g[t]);if(0!==x.length){for(t=0;t<a.length&&i.substr(0,a[t].length)!==a[t];++t);if(t<a.length){if(u=t,1===t&&(o=x[1]),6===t)return{name:o,c:d,A:numeric.transpose(y),b:v,rows:f,vars:m}}else switch(u){case 0:case 1:e("Unexpected line");case 2:switch(x[0]){case"N":0===s?s=x[1]:e("Two or more N rows");break;case"L":f[x[1]]=l,h[l]=1,v[l]=0,++l;break;case"G":f[x[1]]=l,h[l]=-1,v[l]=0,++l;break;case"E":f[x[1]]=l,h[l]=0,v[l]=0,++l;break;default:e("Parse error "+numeric.prettyPrint(x))}break;case 3:m.hasOwnProperty(x[0])||(m[x[0]]=p,d[p]=0,y[p]=numeric.rep([l],0),++p);var b=m[x[0]];for(t=1;t<x.length;t+=2)if(x[t]!==s){var M=f[x[t]];y[b][M]=(h[M]<0?-1:1)*parseFloat(x[t+1])}else d[b]=parseFloat(x[t+1]);break;case 4:for(t=1;t<x.length;t+=2)v[f[x[t]]]=(h[f[x[t]]]<0?-1:1)*parseFloat(x[t+1]);break;case 5:break;case 6:e("Internal error")}}}e("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(r,e,n,t,i,o,u){function a(r){var e,t,i=this,o=r.length,u=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],o||(r=[o++]);u<n;)i.S[u]=u++;for(u=0;u<n;u++)e=i.S[u],a=f(a+e+r[u%o]),t=i.S[a],i.S[u]=t,i.S[a]=e;i.g=function(r){var e=i.S,t=f(i.i+1),o=e[t],u=f(i.j+o),a=e[u];e[t]=a,e[u]=o;for(var c=e[f(o+a)];--r;)t=f(t+1),o=e[t],u=f(u+o),a=e[u],e[t]=a,e[u]=o,c=c*n+e[f(o+a)];return i.i=t,i.j=u,c},i.g(n)}function c(r,e,n,t,i){if(n=[],i=typeof r,e&&"object"==i)for(t in r)if(t.indexOf("S")<5)try{n.push(c(r[t],e-1))}catch(r){}return n.length?n:r+("string"!=i?"\0":"")}function s(r,e,n,t){for(r+="",n=0,t=0;t<r.length;t++)e[f(t)]=f((n^=19*e[f(t)])+r.charCodeAt(t));r="";for(t in e)r+=String.fromCharCode(e[t]);return r}function f(r){return r&n-1}e.seedrandom=function(f,h){var l,m=[];return f=s(c(h?[f,r]:arguments.length?f:[(new Date).getTime(),r,window],3),m),l=new a(m),s(l.S,r),e.random=function(){for(var r=l.g(t),e=u,a=0;r<i;)r=(r+a)*n,e*=n,a=l.g(1);for(;r>=o;)r/=2,e/=2,a>>>=1;return(r+a)/e},f},u=e.pow(n,t),i=e.pow(2,i),o=2*i,s(e.random(),r)}([],numeric.seedrandom,256,6,52),function(r){function e(r){if("object"!=typeof r)return r;var n,t=[],i=r.length;for(n=0;n<i;n++)t[n+1]=e(r[n]);return t}function n(r){if("object"!=typeof r)return r;var e,t=[],i=r.length;for(e=1;e<i;e++)t[e-1]=n(r[e]);return t}function t(r,e,n){var t,i,o,u,a;for(o=1;o<=n;o+=1){for(r[o][o]=1/r[o][o],a=-r[o][o],t=1;t<o;t+=1)r[t][o]=a*r[t][o];if(u=o+1,n<u)break;for(i=u;i<=n;i+=1)for(a=r[o][i],r[o][i]=0,t=1;t<=o;t+=1)r[t][i]=r[t][i]+a*r[t][o]}}function i(r,e,n,t){var i,o,u,a;for(o=1;o<=n;o+=1){for(a=0,i=1;i<o;i+=1)a+=r[i][o]*t[i];t[o]=(t[o]-a)/r[o][o]}for(u=1;u<=n;u+=1)for(o=n+1-u,t[o]=t[o]/r[o][o],a=-t[o],i=1;i<o;i+=1)t[i]=t[i]+a*r[i][o]}function o(r,e,n,t){var i,o,u,a,c,s;for(o=1;o<=n;o+=1){if(t[1]=o,s=0,u=o-1,u<1){if(s=r[o][o]-s,s<=0)break;r[o][o]=Math.sqrt(s)}else{for(a=1;a<=u;a+=1){for(c=r[a][o],i=1;i<a;i+=1)c-=r[i][o]*r[i][a];c/=r[a][a],r[a][o]=c,s+=c*c}if(s=r[o][o]-s,s<=0)break;r[o][o]=Math.sqrt(s)}t[1]=0}}function u(r,e,n,u,a,c,s,f,h,l,m,p,d,y,v,g){function x(){for(y[1]=y[1]+1,k=F,A=1;A<=l;A+=1){for(k+=1,R=-f[A],C=1;C<=u;C+=1)R+=s[C][A]*a[C];if(Math.abs(R)<Y&&(R=0),A>m)v[k]=R;else if(v[k]=-Math.abs(R),R>0){for(C=1;C<=u;C+=1)s[C][A]=-s[C][A];f[A]=-f[A]}}for(A=1;A<=d;A+=1)v[F+p[A]]=0;for(N=0,D=0,A=1;A<=l;A+=1)v[F+A]<D*v[L+A]&&(N=A,D=v[F+A]/v[L+A]);return 0===N?999:0}function b(){for(A=1;A<=u;A+=1){for(R=0,C=1;C<=u;C+=1)R+=r[C][A]*s[C][N];v[A]=R}for(j=P,A=1;A<=u;A+=1)v[j+A]=0;for(C=d+1;C<=u;C+=1)for(A=1;A<=u;A+=1)v[j+A]=v[j+A]+r[A][C]*v[C];for(E=!0,A=d;A>=1;A-=1){for(R=v[A],k=q+A*(A+3)/2,j=k-A,C=A+1;C<=d;C+=1)R-=v[k]*v[O+C],k+=C;if(R/=v[j],v[O+A]=R,p[A]<m)break;if(R<0)break;E=!1,S=A}if(!E)for(H=v[B+S]/v[O+S],A=1;A<=d&&!(p[A]<m)&&!(v[O+A]<0);A+=1)D=v[B+A]/v[O+A],D<H&&(H=D,S=A);for(R=0,A=P+1;A<=P+u;A+=1)R+=v[A]*v[A];if(Math.abs(R)<=Y){if(E)return g[1]=1,999;for(A=1;A<=d;A+=1)v[B+A]=v[B+A]-H*v[O+A];return v[B+d+1]=v[B+d+1]+H,700}for(R=0,A=1;A<=u;A+=1)R+=v[P+A]*s[A][N];for(z=-v[F+N]/R,X=!0,E||H<z&&(z=H,X=!1),A=1;A<=u;A+=1)a[A]=a[A]+z*v[P+A],Math.abs(a[A])<Y&&(a[A]=0);for(c[1]=c[1]+z*R*(z/2+v[B+d+1]),A=1;A<=d;A+=1)v[B+A]=v[B+A]-z*v[O+A];if(v[B+d+1]=v[B+d+1]+z,!X){for(R=-f[N],C=1;C<=u;C+=1)R+=a[C]*s[C][N];if(N>m)v[F+N]=R;else if(v[F+N]=-Math.abs(R),R>0){for(C=1;C<=u;C+=1)s[C][N]=-s[C][N];f[N]=-f[N]}return 700}for(d+=1,p[d]=N,k=q+(d-1)*d/2+1,A=1;A<=d-1;A+=1)v[k]=v[A],k+=1;if(d===u)v[k]=v[u];else{for(A=u;A>=d+1&&0!==v[A]&&(G=Math.max(Math.abs(v[A-1]),Math.abs(v[A])),U=Math.min(Math.abs(v[A-1]),Math.abs(v[A])),D=v[A-1]>=0?Math.abs(G*Math.sqrt(1+U*U/(G*G))):-Math.abs(G*Math.sqrt(1+U*U/(G*G))),G=v[A-1]/D,U=v[A]/D,1!==G);A-=1)if(0===G)for(v[A-1]=U*D,C=1;C<=u;C+=1)D=r[C][A-1],r[C][A-1]=r[C][A],r[C][A]=D;else for(v[A-1]=D,I=U/(1+G),C=1;C<=u;C+=1)D=G*r[C][A-1]+U*r[C][A],r[C][A]=I*(r[C][A-1]+D)-r[C][A],r[C][A-1]=D;v[k]=v[d]}return 0}function M(){if(k=q+S*(S+1)/2+1,j=k+S,0===v[j])return 798;if(G=Math.max(Math.abs(v[j-1]),Math.abs(v[j])),U=Math.min(Math.abs(v[j-1]),Math.abs(v[j])),D=v[j-1]>=0?Math.abs(G*Math.sqrt(1+U*U/(G*G))):-Math.abs(G*Math.sqrt(1+U*U/(G*G))),G=v[j-1]/D,U=v[j]/D,1===G)return 798;if(0===G){for(A=S+1;A<=d;A+=1)D=v[j-1],v[j-1]=v[j],v[j]=D,j+=A;for(A=1;A<=u;A+=1)D=r[A][S],r[A][S]=r[A][S+1],r[A][S+1]=D}else{for(I=U/(1+G),A=S+1;A<=d;A+=1)D=G*v[j-1]+U*v[j],v[j]=I*(v[j-1]+D)-v[j],v[j-1]=D,j+=A;for(A=1;A<=u;A+=1)D=G*r[A][S]+U*r[A][S+1],r[A][S+1]=I*(r[A][S]+D)-r[A][S+1],r[A][S]=D}return 0}function w(){for(j=k-S,A=1;A<=S;A+=1)v[j]=v[k],k+=1,j+=1;return v[B+S]=v[B+S+1],p[S]=p[S+1],S+=1,S<d?797:0}function _(){return v[B+d]=v[B+d+1],v[B+d+1]=0,p[d]=0,d-=1,y[2]=y[2]+1,0}var A,C,k,j,T,S,P,O,q,F,B,N,V,L,D,R,H,z,G,U,I,E,X,Y,Q,Z,W;V=Math.min(u,l),k=2*u+V*(V+5)/2+2*l+1,Y=1e-60;do Y+=Y,Q=1+.1*Y,Z=1+.2*Y;while(Q<=1||Z<=1);for(A=1;A<=u;A+=1)v[A]=e[A];for(A=u+1;A<=k;A+=1)v[A]=0;for(A=1;A<=l;A+=1)p[A]=0;if(T=[],0===g[1]){if(o(r,n,u,T),0!==T[1])return void(g[1]=2);i(r,n,u,e),t(r,n,u)}else{for(C=1;C<=u;C+=1)for(a[C]=0,A=1;A<=C;A+=1)a[C]=a[C]+r[A][C]*e[A];for(C=1;C<=u;C+=1)for(e[C]=0,A=C;A<=u;A+=1)e[C]=e[C]+r[C][A]*a[A]}for(c[1]=0,C=1;C<=u;C+=1)for(a[C]=e[C],c[1]=c[1]+v[C]*a[C],v[C]=0,A=C+1;A<=u;A+=1)r[A][C]=0;for(c[1]=-c[1]/2,g[1]=0,P=u,O=P+u,B=O+V,q=B+V+1,F=q+V*(V+1)/2,L=F+l,A=1;A<=l;A+=1){for(R=0,C=1;C<=u;C+=1)R+=s[C][A]*s[C][A];v[L+A]=Math.sqrt(R)}for(d=0,y[1]=0,y[2]=0,W=0;;){if(W=x(),999===W)return;for(;;){if(W=b(),0===W)break;if(999===W)return;if(700===W)if(S===d)_();else{for(;;)if(M(),W=w(),797!==W)break;_()}}}}function a(r,t,i,o,a,c){r=e(r),t=e(t),i=e(i);var s,f,h,l,m,p,d=[],y=[],v=[],g=[],x=[];if(a=a||0,c=c?e(c):[void 0,0],o=o?e(o):[],f=r.length-1,h=i[1].length-1,!o)for(s=1;s<=h;s+=1)o[s]=0;for(s=1;s<=h;s+=1)y[s]=0;for(l=0,m=Math.min(f,h),s=1;s<=f;s+=1)v[s]=0;for(d[1]=0,s=1;s<=2*f+m*(m+5)/2+2*h+1;s+=1)g[s]=0;for(s=1;s<=2;s+=1)x[s]=0;return u(r,t,f,f,v,d,i,o,f,h,a,y,l,x,g,c),p="",1===c[1]&&(p="constraints are inconsistent, no solution!"),2===c[1]&&(p="matrix D in quadratic function is not positive definite!"),{solution:n(v),value:n(d),unconstrained_solution:n(t),iterations:n(x),iact:n(y),message:p}}r.solveQP=a}(numeric),numeric.svd=function(r){function e(r,e){return r=Math.abs(r),e=Math.abs(e),r>e?r*Math.sqrt(1+e*e/r/r):0==e?r:e*Math.sqrt(1+r*r/e/e)}var n,t=numeric.epsilon,i=1e-64/t,o=50,u=0,a=0,c=0,s=0,f=0,h=numeric.clone(r),l=h.length,m=h[0].length;if(l<m)throw"Need more rows than columns";var p=new Array(m),d=new Array(m);for(a=0;a<m;a++)p[a]=d[a]=0;var y=numeric.rep([m,m],0),v=0,g=0,x=0,b=0,M=0,w=0,_=0;for(a=0;a<m;a++){for(p[a]=g,_=0,f=a+1,c=a;c<l;c++)_+=h[c][a]*h[c][a];if(_<=i)g=0;else for(v=h[a][a],g=Math.sqrt(_),v>=0&&(g=-g),x=v*g-_,h[a][a]=v-g,c=f;c<m;c++){for(_=0,s=a;s<l;s++)_+=h[s][a]*h[s][c];for(v=_/x,s=a;s<l;s++)h[s][c]+=v*h[s][a]}for(d[a]=g,_=0,c=f;c<m;c++)_+=h[a][c]*h[a][c];if(_<=i)g=0;else{for(v=h[a][a+1],g=Math.sqrt(_),v>=0&&(g=-g),x=v*g-_,h[a][a+1]=v-g,c=f;c<m;c++)p[c]=h[a][c]/x;for(c=f;c<l;c++){for(_=0,s=f;s<m;s++)_+=h[c][s]*h[a][s];for(s=f;s<m;s++)h[c][s]+=_*p[s]}}M=Math.abs(d[a])+Math.abs(p[a]),M>b&&(b=M)}for(a=m-1;a!=-1;a+=-1){if(0!=g){for(x=g*h[a][a+1],c=f;c<m;c++)y[c][a]=h[a][c]/x;for(c=f;c<m;c++){for(_=0,s=f;s<m;s++)_+=h[a][s]*y[s][c];for(s=f;s<m;s++)y[s][c]+=_*y[s][a]}}for(c=f;c<m;c++)y[a][c]=0,y[c][a]=0;y[a][a]=1,g=p[a],f=a}for(a=m-1;a!=-1;a+=-1){for(f=a+1,g=d[a],c=f;c<m;c++)h[a][c]=0;if(0!=g){for(x=h[a][a]*g,c=f;c<m;c++){for(_=0,s=f;s<l;s++)_+=h[s][a]*h[s][c];for(v=_/x,s=a;s<l;s++)h[s][c]+=v*h[s][a]}for(c=a;c<l;c++)h[c][a]=h[c][a]/g}else for(c=a;c<l;c++)h[c][a]=0;h[a][a]+=1}for(t*=b,s=m-1;s!=-1;s+=-1)for(var A=0;A<o;A++){var C=!1;for(f=s;f!=-1;f+=-1){if(Math.abs(p[f])<=t){C=!0;break}if(Math.abs(d[f-1])<=t)break}if(!C){u=0,_=1;var k=f-1;for(a=f;a<s+1&&(v=_*p[a],p[a]=u*p[a],!(Math.abs(v)<=t));a++)for(g=d[a],x=e(v,g),d[a]=x,u=g/x,_=-v/x,c=0;c<l;c++)M=h[c][k],w=h[c][a],h[c][k]=M*u+w*_,h[c][a]=-M*_+w*u}if(w=d[s],f==s){if(w<0)for(d[s]=-w,c=0;c<m;c++)y[c][s]=-y[c][s];break}if(A>=o-1)throw"Error: no convergence.";for(b=d[f],M=d[s-1],g=p[s-1],x=p[s],v=((M-w)*(M+w)+(g-x)*(g+x))/(2*x*M),g=e(v,1),v=v<0?((b-w)*(b+w)+x*(M/(v-g)-x))/b:((b-w)*(b+w)+x*(M/(v+g)-x))/b,u=1,_=1,a=f+1;a<s+1;a++){for(g=p[a],M=d[a],x=_*g,g=u*g,w=e(v,x),p[a-1]=w,u=v/w,_=x/w,v=b*u+g*_,g=-b*_+g*u,x=M*_,M*=u,c=0;c<m;c++)b=y[c][a-1],w=y[c][a],y[c][a-1]=b*u+w*_,y[c][a]=-b*_+w*u;for(w=e(v,x),d[a-1]=w,u=v/w,_=x/w,v=u*g+_*M,b=-_*g+u*M,c=0;c<l;c++)M=h[c][a-1],w=h[c][a],h[c][a-1]=M*u+w*_,h[c][a]=-M*_+w*u}p[f]=0,p[s]=v,d[s]=b}for(a=0;a<d.length;a++)d[a]<t&&(d[a]=0);for(a=0;a<m;a++)for(c=a-1;c>=0;c--)if(d[c]<d[a]){for(u=d[c],d[c]=d[a],d[a]=u,s=0;s<h.length;s++)n=h[s][a],h[s][a]=h[s][c],h[s][c]=n;for(s=0;s<y.length;s++)n=y[s][a],y[s][a]=y[s][c],y[s][c]=n;a=c}return{U:h,S:d,V:y}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(r,e,n){function t(r,e,n,t,i){return u(0,r,e,n,t,i)}function i(r,e,n,t,i){var o,a,c,s;return 0==e?(o=u(1,r,1,n,t,i),a=u(-1,r,-1,n,t,i),c=o+a):e>0?(s=1==e?1:0,o=u(1,r,e-1,n,t,i),a=u(-1,r,-e+1,n,t,i),c=o*Math.sqrt(1+s)-a*(1-s)):(s=e==-1?1:0,o=u(1,r,e+1,n,t,i),a=u(-1,r,-e-1,n,t,i),c=o*(1-s)+a*Math.sqrt(1+s)),c}function o(r,e,n,t,i){var o,a,c;return 0==e?console.error("should not be called"):e>0?(o=u(1,r,e+1,n,t,i),a=u(-1,r,-e-1,n,t,i),c=o+a):(o=u(1,r,e-1,n,t,i),a=u(-1,r,-e+1,n,t,i),c=o-a),c}function u(r,e,n,t,i,o){var u,a,c,s;return u=i[r+1][2],a=i[r+1][0],c=i[r+1][1],s=t==-e?u*o[n+e-1][0]+a*o[n+e-1][2*e-2]:t==e?u*o[n+e-1][2*e-2]-a*o[n+e-1][0]:c*o[n+e-1][t+e-1]}var a=r("numeric"),c=function(r,e,n,t){var i,o=e.length,u=(r+1)*(r+1),c=[,];u>o&&console.log("The SHT degree is too high for the number of data points"),0==n&&(e=h(e));for(var s=0;s<e.length;s++)c[s]=e[s][2];Y_N=m(r,e),i=0==t?a.mul(1/o,Y_N):v(a.transpose(Y_N));var f=a.dotMV(i,c);return f},s=function(r,e){for(var n=e,t=Math.sqrt(r.length)-1,i=m(t,e),o=a.dotVM(r,i),u=0;u<e.length;u++)n[u][2]=o[u];return n},f=function(r){for(var e=0;e<r.length;e++)console.log(r[e])},h=function(r,e){for(var n,t,i,o=new Array(r.length),u=0;u<r.length;u++)n=Math.atan2(r[u][1],r[u][0]),t=Math.atan2(r[u][2],Math.sqrt(r[u][0]*r[u][0]+r[u][1]*r[u][1])),1==e?o[u]=[n,t]:(i=Math.sqrt(r[u][0]*r[u][0]+r[u][1]*r[u][1]+r[u][2]*r[u][2]),o[u]=[n,t,i]);return o},l=function(r){for(var e,n,t,i=new Array(r.length),o=0;o<r.length;o++)e=Math.cos(r[o][0])*Math.cos(r[o][1]),n=Math.sin(r[o][0])*Math.cos(r[o][1]),t=Math.sin(r[o][1]),2==r[0].length?i[o]=[e,n,t]:3==r[0].length&&(i[o]=[r[o][2]*e,r[o][2]*n,r[o][2]*t]);return i},m=function(r,e){for(var n=new Array(e.length),t=new Array(e.length),i=0;i<e.length;i++)n[i]=e[i][0],t[i]=e[i][1];for(var o,u,c,s,f,h=new Array(2*r+1),l=(n.length,(r+1)*(r+1)),m=0,y=0,v=a.sin(t),g=0,x=new Array(l),i=0;i<2*r+1;i++)h[i]=p(i);for(var b=0;b<r+1;b++){if(0==b){var M=new Array(n.length);M.fill(1),x[b]=M,g=1}else{o=d(b,v,m,y),u=Math.sqrt(2*b+1);for(var w=0;w<b+1;w++)0==w?x[g+b]=a.mul(u,o[w]):(c=u*Math.sqrt(2*h[b-w]/h[b+w]),s=a.cos(a.mul(w,n)),f=a.sin(a.mul(w,n)),x[g+b-w]=a.mul(c,a.mul(o[w],f)),x[g+b+w]=a.mul(c,a.mul(o[w],s)));g=g+2*b+1}y=m,m=o}return x},p=function(r){return 0===r?1:r*p(r-1)},d=function(r,e,n,t){var i=new Array(r+1);switch(r){case 1:var o=a.mul(e,e),u=e,c=a.sqrt(a.sub(1,o));i[0]=u,i[1]=c;break;case 2:var o=a.mul(e,e),s=a.mul(3,o);s=a.sub(s,1),s=a.div(s,2);var f=a.sub(1,o);f=a.sqrt(f),f=a.mul(3,f),f=a.mul(f,e);var h=a.sub(1,o);h=a.mul(3,h),i[0]=s,i[1]=f,i[2]=h;break;default:var o=a.mul(e,e),l=a.sub(1,o),m=2*r-1,p=1;if(m%2==0)for(var d=1;d<m/2+1;d++)p=2*p*d;else for(var d=1;d<(m+1)/2+1;d++)p*=2*d-1;
i[r]=a.mul(p,a.pow(l,r/2)),i[r-1]=a.mul(2*r-1,a.mul(e,n[r-1]));for(var y=0;y<r-1;y++){var v=a.mul(2*r-1,a.mul(e,n[y])),g=a.mul(r+y-1,t[y]);i[y]=a.div(a.sub(v,g),r-y)}}return i},y=function(r){for(var e=a.svd(r),n=e.S[0],t=e.U,i=e.S,o=e.V,u=r.length,c=r[0].length,s=Math.max(u,c)*a.epsilon*n,f=i.length,h=new Array(f),l=f-1;l!==-1;l--)i[l]>s?h[l]=1/i[l]:h[l]=0;return a.dot(a.dot(o,a.diag(h)),a.transpose(t))},v=function(r){var e=a.transpose(r);return a.dot(a.inv(a.dot(e,r)),e)},g=function(r,e){var n=(e+1)*(e+1),u=a.rep([n,n],0);u[0][0]=1;var c=a.rep([3,3],0);c[0][0]=r[1][1],c[0][1]=r[1][2],c[0][2]=r[1][0],c[1][0]=r[2][1],c[1][1]=r[2][2],c[1][2]=r[2][0],c[2][0]=r[0][1],c[2][1]=r[0][2],c[2][2]=r[0][0],u=a.setBlock(u,[1,1],[3,3],c);for(var s=c,f=3,h=2;h<e+1;h++){for(var l=a.rep([2*h+1,2*h+1],0),m=-h;m<h+1;m++)for(var p=-h;p<h+1;p++){var d,y,v,g,x;d=0==m?1:0,y=Math.abs(p)==h?2*h*(2*h-1):h*h-p*p,v=Math.sqrt((h*h-m*m)/y),g=Math.sqrt((1+d)*(h+Math.abs(m)-1)*(h+Math.abs(m))/y)*(1-2*d)*.5,x=Math.sqrt((h-Math.abs(m)-1)*(h-Math.abs(m))/y)*(1-d)*-.5,0!=v&&(v*=t(h,m,p,c,s)),0!=g&&(g*=i(h,m,p,c,s)),0!=x&&(x*=o(h,m,p,c,s)),l[m+h][p+h]=v+g+x}u=a.setBlock(u,[f+1,f+1],[f+2*h+1,f+2*h+1],l),s=l,f=f+2*h+1}return u},x=function(r,e,n){var t,i,o;t=0==n?[[1,0,0],[0,1,0],[0,0,1]]:[[1,0,0],[0,Math.cos(n),Math.sin(n)],[0,-Math.sin(n),Math.cos(n)]],i=0==e?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(e),0,-Math.sin(e)],[0,1,0],[Math.sin(e),0,Math.cos(e)]],o=0==r?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(r),Math.sin(r),0],[-Math.sin(r),Math.cos(r),0],[0,0,1]];var u=a.dotMMsmall(i,o);return u=a.dotMMsmall(t,u)};e.exports.forwardSHT=c,e.exports.inverseSHT=s,e.exports.print2Darray=f,e.exports.convertCart2Sph=h,e.exports.convertSph2Cart=l,e.exports.computeRealSH=m,e.exports.factorial=p,e.exports.recurseLegendrePoly=d,e.exports.pinv_svd=y,e.exports.pinv_direct=v,e.exports.getSHrotMtx=g,e.exports.yawPitchRoll2Rzyx=x},{numeric:31}]},{},[10])(10)});